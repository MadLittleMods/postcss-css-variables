{"version":3,"sources":["../../es-module-loader/core/common.js","../../es-module-loader/core/resolve.js","../../es-module-loader/core/loader-polyfill.js","../../es-module-loader/core/register-loader.js","../src/common.js","../src/fetch.js","../src/resolve.js","../src/config.js","../src/evaluate.js","../src/format-helpers.js","../src/instantiate.js","../src/systemjs-loader.js","../src/system.js"],"names":["isBrowser","window","document","isNode","process","versions","node","isWindows","platform","match","envGlobal","self","global","hasSymbol","Symbol","createSymbol","name","baseURI","toStringTag","getElementsByTagName","bases","href","location","slashIndex","split","lastIndexOf","substr","cwd","TypeError","replace","length","errArgs","Error","fileName","LoaderError__Check_error_message_for_loader_stack","childErr","newMessage","err","message","lineNumber","stack","originalErr","throwResolveError","relUrl","parentUrl","RangeError","backslashRegEx","resolveIfNotPlain","trim","parentProtocol","indexOf","firstChar","secondChar","pathname","parentIsPlain","undefined","segmented","output","segmentIndex","i","pop","push","substring","join","resolvedPromise","Promise","resolve","arrayValues","arr","values","iterator","iterable","keys","Object","keyIndex","next","value","done","Loader","this","registry","Registry","ensureInstantiated","module","ModuleNamespace","prototype","constructor","import","key","parent","loader","then","RESOLVE_INSTANTIATE","catch","addToError","RESOLVE","resolveInstantiate","ensureResolution","resolvedKey","resolved","get","iteratorSupport","REGISTRY","entries","map","set","namespace","has","hasOwnProperty","call","delete","BASE_OBJECT","baseObject","defineProperty","forEach","extendNamespace","enumerable","create","REGISTER_INTERNAL","RegisterLoader","registryDelete","deleted","records","linkRecord","lastRegister","trace","INSTANTIATE","instantiate","createLoadRecord","state","registration","importerSetters","loadError","evalError","instantiatePromise","dependencies","execute","executingRequire","moduleObj","setters","depsInstantiatePromise","dependencyInstantiations","evaluatePromise","load","link","instantiation","traceLoad","declare","definedExports","declared","default","__useDefault","changed","p","ContextualLoader","exports","resolveInstantiateDep","parentKey","traceDepMap","loads","deps","dynamicDeps","depMap","id","meta","url","doEvaluateDeclarative","seen","depLink","depLoadPromises","depLoad","depLoadPromise","e","doEvaluateDynamic","all","execPromise","nullContext","configurable","require","moduleDefault","__esModule","processAnonRegister","reject","instantiated","addDeps","depsInstantiatePromises","Array","setter","instantiateDeps","depPromises","ensureEvaluate","register","registerDynamic","freeze","noop","emptyModule","parentModuleContext","CONFIG","METADATA","isWorker","importScripts","warn","msg","force","warnings","console","extend","a","b","prepend","extendMeta","_prepend","val","concat","supportsPreload","supportsPrefetch","preloadScript","createElement","rel","as","head","appendChild","Image","src","relList","supports","onerror","apply","arguments","scriptLoad","crossOrigin","integrity","workerImport","script","cleanup","error","removeEventListener","removeChild","type","charset","async","addEventListener","readMemberExpression","pParts","shift","applyPaths","baseURL","paths","mapMatch","getMapMatch","target","checkMap","curLen","len","bestMatch","fs","cjsRequireRegEx","fetchFetch","authorization","asBuffer","hasXhr","xhrFetch","opts","headers","Accept","credentials","fetch","res","ok","arrayBuffer","text","status","statusText","xhr","XMLHttpRequest","response","responseText","responseType","onreadystatechange","readyState","open","setRequestHeader","withCredentials","send","hasFetch","fetch$1","readFile","data","dataString","getParentMetadata","config","parentPluginIndex","parentMetadata","pluginKey","pluginArgument","pluginModule","packageKey","packageConfig","pluginFirst","packages","decanonicalize","parsed","parsePlugin","plugin","combinePluginParts","coreResolve","argument","doMap","packageName","relativeResolved","trailingSlash","packageResolveSync","metadata","skipExtensions","parentMap","parentMapMatch","mapped","doMapSync","normalized","pkgConfigMatch","getPackageConfigMatch","packageConfigKeys","createPackage","subPath","pkg","pkgKey","main","mapPath","addDefaultExtension","applyPackageConfigSync","packageResolve","createMeta","format","configured","pkgConfigPath","configLoader","pluginLoader","pkgConfig","setPkgConfig","loadPackageConfigPath","configPath","applyPackageConfig","extension","globals","nonce","sourceMap","encapsulateGlobal","cjsRequireDetection","cjsDeferDepsExecute","esModule","argumentKey","pluginIndex","defaultExtension","metaMatch","getMetaMatches","metaPattern","matchMeta","matchDepth","validMapping","path","interpolateConditional","conditionPromises","conditions","c","parseCondition","condition","conditionValues","prop","negate","packageConfigPaths","lastWildcard","exactMatch","packageConfigPath","Math","max","regEx","RegExp","wildcard","pkgMeta","matchFn","wildcardIndex","dotRel","exactMeta","sysConditions","conditionExport","conditionModule","negation","conditionExportIndex","resolveCondition","conditionObj","bool","m","interpolationRegEx","conditionalMatch","conditionValue","envConfigNames","envSet","cfg","envCallback","envConfig","envModule","getConfigItem","cfgItem","cloneObj","obj","maxDepth","clone","pkgName","prependConfig","hasBuffer","Buffer","toString","vm","useVm","curSystem","sourceMapPrefix","getSource","source","address","wrap","sourceMapString","lastLineIndex","JSON","stringify","btoa","unescape","encodeURIComponent","callCounter","preExec","System","SystemJS","postExec","windowOrigin","supportsScriptExec","evaluate","noWrap","body","documentElement","_e","setAttribute","scriptExec","_nodeRequire","runInThisContext","filename","eval","setAmdHelper","names","callback","errback","referer","splice","dynamicRequires","modules","define","factory","requireIndex","exportsIndex","moduleIndex","req","depValues","uri","contextualRequire","toUrl","normalizeSync","curRequire","curMetaDeps","requireAlias","commentRegEx","fnBracketRegEx","wsRegEx","requireRegEx","requireRegExs","cjsRequirePre","cjsRequirePost","lastIndex","exec","amdGetCJSDeps","lastNamedDefine","multipleNamedDefines","curEsModule","wrapEsModuleExecute","amd","amdDefine","amdRequire","stripOrigin","requireResolve","request","parentId","getPathVars","moduleId","dirname","chrome","navigator","userAgent","protocol","hostname","port","stringRegEx","globalSnapshot","ignoredGlobalProps","globalIterator","globalName","getGlobalValue","globalValue","prepareGlobal","moduleName","encapsulate","oldGlobals","curDefine","g","singleGlobal","multipleExports","nodeRequire","supportsScriptLoad","setMetaEsModule","moduleValue","translateAndInstantiate","metaRegEx","metaParts","metaPartRegEx","curPart","metaString","metaName","metaValue","setMetaProperty","readMetaSyntax","pluginLoad","translate","traceOpts","translated","sanitizeSourceMap","detectRegisterFormat","esmRegEx","transpiler","depsPrefix","parse","transpile","calledInstantiate","result","bindings","protectedCreateNamespace","amdRegEx","cjsExportsRegEx","metaDeps","registered","newModule","stringLocations","commentLocations","inLocation","locations","index","dep","getCJSDeps","pathVars","__cjsWrapper","args","cjsWrapper","hashBangRegEx","gl","exportName","retrieveGlobal","browser","leadingCommentAndMetaRegEx","leadingCommentAndMeta","codeStart","startsWith","originalName","file","sources","scriptSrc","scripts","curScript","currentScript","defer","__filename","SystemJSLoader","_loader","depCache","bundles","production","loadedBundles","wasm","setProduction","bind","isProduction","isBuilder","dev","build","normalize","booleanIndex","bestDepth","depth","resolveSync","matched","curModule","parts","loadBundlesAndDepCache","Module","base","decodeURI","_nodeModulePaths","locate","fetched","wasmBuffer","bytes","Uint8Array","WebAssembly","compile","importObj","imports","_export","Instance","wasmInstantiated","stringSource","TextDecoder","decode","isEnvConfig","defaultJSExtensions","v","packageLength","bundle","configNames","getConfig","configName","configItem","hasProxy","Proxy","option","registryWarn","method","isModule","version"],"mappings":"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","sourcesContent":["/*\r\n * Environment\r\n */\r\nexport var isBrowser = typeof window !== 'undefined' && typeof document !== 'undefined';\r\nexport var isNode = typeof process !== 'undefined' && process.versions && process.versions.node;\r\nexport var isWindows = typeof process !== 'undefined' && typeof process.platform === 'string' && process.platform.match(/^win/);\r\n\r\nvar envGlobal = typeof self !== 'undefined' ? self : global;\r\nexport { envGlobal as global }\r\n\r\n/*\r\n * Simple Symbol() shim\r\n */\r\nvar hasSymbol = typeof Symbol !== 'undefined';\r\nexport function createSymbol (name) {\r\n  return hasSymbol ? Symbol() : '@@' + name;\r\n}\r\n\r\nexport var toStringTag = hasSymbol && Symbol.toStringTag;\r\n\r\nexport function pathToFileUrl (filePath) {\r\n  return 'file://' + (isWindows ? '/' : '') + (isWindows ? filePath.replace(/\\\\/g, '/') : filePath);\r\n}\r\n\r\nexport function fileUrlToPath (fileUrl) {\r\n  if (fileUrl.substr(0, 7) !== 'file://')\r\n    throw new RangeError(fileUrl + ' is not a valid file url');\r\n  if (isWindows)\r\n    return fileUrl.substr(8).replace(/\\\\/g, '/');\r\n  else\r\n    return fileUrl.substr(7);\r\n}\r\n\r\n/*\r\n * Environment baseURI\r\n */\r\nexport var baseURI;\r\n\r\n// environent baseURI detection\r\nif (typeof document != 'undefined' && document.getElementsByTagName) {\r\n  baseURI = document.baseURI;\r\n\r\n  if (!baseURI) {\r\n    var bases = document.getElementsByTagName('base');\r\n    baseURI = bases[0] && bases[0].href || window.location.href;\r\n  }\r\n}\r\nelse if (typeof location != 'undefined') {\r\n  baseURI = location.href;\r\n}\r\n\r\n// sanitize out the hash and querystring\r\nif (baseURI) {\r\n  baseURI = baseURI.split('#')[0].split('?')[0];\r\n  var slashIndex = baseURI.lastIndexOf('/');\r\n  if (slashIndex !== -1)\r\n    baseURI = baseURI.substr(0, slashIndex + 1);\r\n}\r\nelse if (typeof process !== 'undefined' && process.cwd) {\r\n  baseURI = 'file://' + (isWindows ? '/' : '') + process.cwd();\r\n  if (isWindows)\r\n    baseURI = baseURI.replace(/\\\\/g, '/');\r\n}\r\nelse {\r\n  throw new TypeError('No environment baseURI');\r\n}\r\n\r\n// ensure baseURI has trailing \"/\"\r\nif (baseURI[baseURI.length - 1] !== '/')\r\n  baseURI += '/';\r\n\r\n/*\r\n * LoaderError with chaining for loader stacks\r\n */\r\nvar errArgs = new Error(0, '_').fileName == '_';\r\nfunction LoaderError__Check_error_message_for_loader_stack (childErr, newMessage) {\r\n  // Convert file:/// URLs to paths in Node\r\n  if (!isBrowser)\r\n    newMessage = newMessage.replace(isWindows ? /file:\\/\\/\\//g : /file:\\/\\//g, '');\r\n\r\n  var message = (childErr.message || childErr) + '\\n  ' + newMessage;\r\n\r\n  var err;\r\n  if (errArgs && childErr.fileName)\r\n    err = new Error(message, childErr.fileName, childErr.lineNumber);\r\n  else\r\n    err = new Error(message);\r\n\r\n\r\n  var stack = childErr.originalErr ? childErr.originalErr.stack : childErr.stack;\r\n\r\n  if (isNode)\r\n    // node doesn't show the message otherwise\r\n    err.stack = message + '\\n  ' + stack;\r\n  else\r\n    err.stack = stack;\r\n\r\n  err.originalErr = childErr.originalErr || childErr;\r\n\r\n  return err;\r\n}\r\nexport { LoaderError__Check_error_message_for_loader_stack as addToError }\r\n","import { isNode } from './common.js';\r\n\r\n/*\r\n * Optimized URL normalization assuming a syntax-valid URL parent\r\n */\r\nfunction throwResolveError (relUrl, parentUrl) {\r\n  throw new RangeError('Unable to resolve \"' + relUrl + '\" to ' + parentUrl);\r\n}\r\nvar backslashRegEx = /\\\\/g;\r\nexport function resolveIfNotPlain (relUrl, parentUrl) {\r\n  if (relUrl[0] === ' ' || relUrl[relUrl.length - 1] === ' ')\r\n    relUrl = relUrl.trim();\r\n  var parentProtocol = parentUrl && parentUrl.substr(0, parentUrl.indexOf(':') + 1);\r\n\r\n  var firstChar = relUrl[0];\r\n  var secondChar = relUrl[1];\r\n\r\n  // protocol-relative\r\n  if (firstChar === '/' && secondChar === '/') {\r\n    if (!parentProtocol)\r\n      throwResolveError(relUrl, parentUrl);\r\n    if (relUrl.indexOf('\\\\') !== -1)\r\n      relUrl = relUrl.replace(backslashRegEx, '/');\r\n    return parentProtocol + relUrl;\r\n  }\r\n  // relative-url\r\n  else if (firstChar === '.' && (secondChar === '/' || secondChar === '.' && (relUrl[2] === '/' || relUrl.length === 2 && (relUrl += '/')) ||\r\n      relUrl.length === 1  && (relUrl += '/')) ||\r\n      firstChar === '/') {\r\n    if (relUrl.indexOf('\\\\') !== -1)\r\n      relUrl = relUrl.replace(backslashRegEx, '/');\r\n    var parentIsPlain = !parentProtocol || parentUrl[parentProtocol.length] !== '/';\r\n\r\n    // read pathname from parent if a URL\r\n    // pathname taken to be part after leading \"/\"\r\n    var pathname;\r\n    if (parentIsPlain) {\r\n      // resolving to a plain parent -> skip standard URL prefix, and treat entire parent as pathname\r\n      if (parentUrl === undefined)\r\n        throwResolveError(relUrl, parentUrl);\r\n      pathname = parentUrl;\r\n    }\r\n    else if (parentUrl[parentProtocol.length + 1] === '/') {\r\n      // resolving to a :// so we need to read out the auth and host\r\n      if (parentProtocol !== 'file:') {\r\n        pathname = parentUrl.substr(parentProtocol.length + 2);\r\n        pathname = pathname.substr(pathname.indexOf('/') + 1);\r\n      }\r\n      else {\r\n        pathname = parentUrl.substr(8);\r\n      }\r\n    }\r\n    else {\r\n      // resolving to :/ so pathname is the /... part\r\n      pathname = parentUrl.substr(parentProtocol.length + 1);\r\n    }\r\n\r\n    if (firstChar === '/') {\r\n      if (parentIsPlain)\r\n        throwResolveError(relUrl, parentUrl);\r\n      else\r\n        return parentUrl.substr(0, parentUrl.length - pathname.length - 1) + relUrl;\r\n    }\r\n\r\n    // join together and split for removal of .. and . segments\r\n    // looping the string instead of anything fancy for perf reasons\r\n    // '../../../../../z' resolved to 'x/y' is just 'z' regardless of parentIsPlain\r\n    var segmented = pathname.substr(0, pathname.lastIndexOf('/') + 1) + relUrl;\r\n\r\n    var output = [];\r\n    var segmentIndex = -1;\r\n\r\n    for (var i = 0; i < segmented.length; i++) {\r\n      // busy reading a segment - only terminate on '/'\r\n      if (segmentIndex !== -1) {\r\n        if (segmented[i] === '/') {\r\n          output.push(segmented.substring(segmentIndex, i + 1));\r\n          segmentIndex = -1;\r\n        }\r\n        continue;\r\n      }\r\n\r\n      // new segment - check if it is relative\r\n      if (segmented[i] === '.') {\r\n        // ../ segment\r\n        if (segmented[i + 1] === '.' && (segmented[i + 2] === '/' || i + 2 === segmented.length)) {\r\n          output.pop();\r\n          i += 2;\r\n        }\r\n        // ./ segment\r\n        else if (segmented[i + 1] === '/' || i + 1 === segmented.length) {\r\n          i += 1;\r\n        }\r\n        else {\r\n          // the start of a new segment as below\r\n          segmentIndex = i;\r\n          continue;\r\n        }\r\n\r\n        // this is the plain URI backtracking error (../, package:x -> error)\r\n        if (parentIsPlain && output.length === 0)\r\n          throwResolveError(relUrl, parentUrl);\r\n\r\n        continue;\r\n      }\r\n\r\n      // it is the start of a new segment\r\n      segmentIndex = i;\r\n    }\r\n    // finish reading out the last segment\r\n    if (segmentIndex !== -1)\r\n      output.push(segmented.substr(segmentIndex));\r\n\r\n    return parentUrl.substr(0, parentUrl.length - pathname.length) + output.join('');\r\n  }\r\n\r\n  // sanitizes and verifies (by returning undefined if not a valid URL-like form)\r\n  // Windows filepath compatibility is an added convenience here\r\n  var protocolIndex = relUrl.indexOf(':');\r\n  if (protocolIndex !== -1) {\r\n    if (isNode) {\r\n      // C:\\x becomes file:///c:/x (we don't support C|\\x)\r\n      if (relUrl[1] === ':' && relUrl[2] === '\\\\' && relUrl[0].match(/[a-z]/i))\r\n        return 'file:///' + relUrl.replace(backslashRegEx, '/');\r\n    }\r\n    return relUrl;\r\n  }\r\n}\r\n","import { addToError, createSymbol, toStringTag } from './common.js';\r\n\r\nexport { Loader, ModuleNamespace, REGISTRY }\r\n\r\nvar resolvedPromise = Promise.resolve();\r\n\r\n/*\r\n * Simple Array values shim\r\n */\r\nfunction arrayValues (arr) {\r\n  if (arr.values)\r\n    return arr.values();\r\n\r\n  if (typeof Symbol === 'undefined' || !Symbol.iterator)\r\n    throw new Error('Symbol.iterator not supported in this browser');\r\n\r\n  var iterable = {};\r\n  iterable[Symbol.iterator] = function () {\r\n    var keys = Object.keys(arr);\r\n    var keyIndex = 0;\r\n    return {\r\n      next: function () {\r\n        if (keyIndex < keys.length)\r\n          return {\r\n            value: arr[keys[keyIndex++]],\r\n            done: false\r\n          };\r\n        else\r\n          return {\r\n            value: undefined,\r\n            done: true\r\n          };\r\n      }\r\n    };\r\n  };\r\n  return iterable;\r\n}\r\n\r\n/*\r\n * 3. Reflect.Loader\r\n *\r\n * We skip the entire native internal pipeline, just providing the bare API\r\n */\r\n// 3.1.1\r\nfunction Loader () {\r\n  this.registry = new Registry();\r\n}\r\n// 3.3.1\r\nLoader.prototype.constructor = Loader;\r\n\r\nfunction ensureInstantiated (module) {\r\n  if (module === undefined)\r\n    return;\r\n  if (module instanceof ModuleNamespace === false && module[toStringTag] !== 'module')\r\n    throw new TypeError('Module instantiation did not return a valid namespace object.');\r\n  return module;\r\n}\r\n\r\n// 3.3.2\r\nLoader.prototype.import = function (key, parent) {\r\n  if (typeof key !== 'string')\r\n    throw new TypeError('Loader import method must be passed a module key string');\r\n  // custom resolveInstantiate combined hook for better perf\r\n  var loader = this;\r\n  return resolvedPromise\r\n  .then(function () {\r\n    return loader[RESOLVE_INSTANTIATE](key, parent);\r\n  })\r\n  .then(ensureInstantiated)\r\n  //.then(Module.evaluate)\r\n  .catch(function (err) {\r\n    throw addToError(err, 'Loading ' + key + (parent ? ' from ' + parent : ''));\r\n  });\r\n};\r\n// 3.3.3\r\nvar RESOLVE = Loader.resolve = createSymbol('resolve');\r\n\r\n/*\r\n * Combined resolve / instantiate hook\r\n *\r\n * Not in current reduced spec, but necessary to separate RESOLVE from RESOLVE + INSTANTIATE as described\r\n * in the spec notes of this repo to ensure that loader.resolve doesn't instantiate when not wanted.\r\n *\r\n * We implement RESOLVE_INSTANTIATE as a single hook instead of a separate INSTANTIATE in order to avoid\r\n * the need for double registry lookups as a performance optimization.\r\n */\r\nvar RESOLVE_INSTANTIATE = Loader.resolveInstantiate = createSymbol('resolveInstantiate');\r\n\r\n// default resolveInstantiate is just to call resolve and then get from the registry\r\n// this provides compatibility for the resolveInstantiate optimization\r\nLoader.prototype[RESOLVE_INSTANTIATE] = function (key, parent) {\r\n  var loader = this;\r\n  return loader.resolve(key, parent)\r\n  .then(function (resolved) {\r\n    return loader.registry.get(resolved);\r\n  });\r\n};\r\n\r\nfunction ensureResolution (resolvedKey) {\r\n  if (resolvedKey === undefined)\r\n    throw new RangeError('No resolution found.');\r\n  return resolvedKey;\r\n}\r\n\r\nLoader.prototype.resolve = function (key, parent) {\r\n  var loader = this;\r\n  return resolvedPromise\r\n  .then(function() {\r\n    return loader[RESOLVE](key, parent);\r\n  })\r\n  .then(ensureResolution)\r\n  .catch(function (err) {\r\n    throw addToError(err, 'Resolving ' + key + (parent ? ' to ' + parent : ''));\r\n  });\r\n};\r\n\r\n// 3.3.4 (import without evaluate)\r\n// this is not documented because the use of deferred evaluation as in Module.evaluate is not\r\n// documented, as it is not considered a stable feature to be encouraged\r\n// Loader.prototype.load may well be deprecated if this stays disabled\r\n/* Loader.prototype.load = function (key, parent) {\r\n  return Promise.resolve(this[RESOLVE_INSTANTIATE](key, parent || this.key))\r\n  .catch(function (err) {\r\n    throw addToError(err, 'Loading ' + key + (parent ? ' from ' + parent : ''));\r\n  });\r\n}; */\r\n\r\n/*\r\n * 4. Registry\r\n *\r\n * Instead of structuring through a Map, just use a dictionary object\r\n * We throw for construction attempts so this doesn't affect the public API\r\n *\r\n * Registry has been adjusted to use Namespace objects over ModuleStatus objects\r\n * as part of simplifying loader API implementation\r\n */\r\nvar iteratorSupport = typeof Symbol !== 'undefined' && Symbol.iterator;\r\nvar REGISTRY = createSymbol('registry');\r\nfunction Registry() {\r\n  this[REGISTRY] = {};\r\n}\r\n// 4.4.1\r\nif (iteratorSupport) {\r\n  // 4.4.2\r\n  Registry.prototype[Symbol.iterator] = function () {\r\n    return this.entries()[Symbol.iterator]();\r\n  };\r\n\r\n  // 4.4.3\r\n  Registry.prototype.entries = function () {\r\n    var registry = this[REGISTRY];\r\n    return arrayValues(Object.keys(registry).map(function (key) {\r\n      return [key, registry[key]];\r\n    }));\r\n  };\r\n}\r\n\r\n// 4.4.4\r\nRegistry.prototype.keys = function () {\r\n  return arrayValues(Object.keys(this[REGISTRY]));\r\n};\r\n// 4.4.5\r\nRegistry.prototype.values = function () {\r\n  var registry = this[REGISTRY];\r\n  return arrayValues(Object.keys(registry).map(function (key) {\r\n    return registry[key];\r\n  }));\r\n};\r\n// 4.4.6\r\nRegistry.prototype.get = function (key) {\r\n  return this[REGISTRY][key];\r\n};\r\n// 4.4.7\r\nRegistry.prototype.set = function (key, namespace) {\r\n  if (!(namespace instanceof ModuleNamespace || namespace[toStringTag] === 'module'))\r\n    throw new Error('Registry must be set with an instance of Module Namespace');\r\n  this[REGISTRY][key] = namespace;\r\n  return this;\r\n};\r\n// 4.4.8\r\nRegistry.prototype.has = function (key) {\r\n  return Object.hasOwnProperty.call(this[REGISTRY], key);\r\n};\r\n// 4.4.9\r\nRegistry.prototype.delete = function (key) {\r\n  if (Object.hasOwnProperty.call(this[REGISTRY], key)) {\r\n    delete this[REGISTRY][key];\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\n/*\r\n * Simple ModuleNamespace Exotic object based on a baseObject\r\n * We export this for allowing a fast-path for module namespace creation over Module descriptors\r\n */\r\n// var EVALUATE = createSymbol('evaluate');\r\nvar BASE_OBJECT = createSymbol('baseObject');\r\n\r\n// 8.3.1 Reflect.Module\r\n/*\r\n * Best-effort simplified non-spec implementation based on\r\n * a baseObject referenced via getters.\r\n *\r\n * Allows:\r\n *\r\n *   loader.registry.set('x', new Module({ default: 'x' }));\r\n *\r\n * Optional evaluation function provides experimental Module.evaluate\r\n * support for non-executed modules in registry.\r\n */\r\nfunction ModuleNamespace (baseObject/*, evaluate*/) {\r\n  Object.defineProperty(this, BASE_OBJECT, {\r\n    value: baseObject\r\n  });\r\n\r\n  // evaluate defers namespace population\r\n  /* if (evaluate) {\r\n    Object.defineProperty(this, EVALUATE, {\r\n      value: evaluate,\r\n      configurable: true,\r\n      writable: true\r\n    });\r\n  }\r\n  else { */\r\n    Object.keys(baseObject).forEach(extendNamespace, this);\r\n  //}\r\n};\r\n// 8.4.2\r\nModuleNamespace.prototype = Object.create(null);\r\n\r\nif (toStringTag)\r\n  Object.defineProperty(ModuleNamespace.prototype, toStringTag, {\r\n    value: 'Module'\r\n  });\r\n\r\nfunction extendNamespace (key) {\r\n  Object.defineProperty(this, key, {\r\n    enumerable: true,\r\n    get: function () {\r\n      return this[BASE_OBJECT][key];\r\n    }\r\n  });\r\n}\r\n\r\n/* function doEvaluate (evaluate, context) {\r\n  try {\r\n    evaluate.call(context);\r\n  }\r\n  catch (e) {\r\n    return e;\r\n  }\r\n}\r\n\r\n// 8.4.1 Module.evaluate... not documented or used because this is potentially unstable\r\nModule.evaluate = function (ns) {\r\n  var evaluate = ns[EVALUATE];\r\n  if (evaluate) {\r\n    ns[EVALUATE] = undefined;\r\n    var err = doEvaluate(evaluate);\r\n    if (err) {\r\n      // cache the error\r\n      ns[EVALUATE] = function () {\r\n        throw err;\r\n      };\r\n      throw err;\r\n    }\r\n    Object.keys(ns[BASE_OBJECT]).forEach(extendNamespace, ns);\r\n  }\r\n  // make chainable\r\n  return ns;\r\n}; */\r\n","import { Loader, ModuleNamespace, REGISTRY } from './loader-polyfill.js';\r\nimport { resolveIfNotPlain } from './resolve.js';\r\nimport { addToError, global, createSymbol, baseURI, toStringTag } from './common.js';\r\n\r\nexport default RegisterLoader;\r\n\r\nvar resolvedPromise = Promise.resolve();\r\nvar emptyArray = [];\r\n\r\n/*\r\n * Register Loader\r\n *\r\n * Builds directly on top of loader polyfill to provide:\r\n * - loader.register support\r\n * - hookable higher-level resolve\r\n * - instantiate hook returning a ModuleNamespace or undefined for es module loading\r\n * - loader error behaviour as in HTML and loader specs, caching load and eval errors separately\r\n * - build tracing support by providing a .trace=true and .loads object format\r\n */\r\n\r\nvar REGISTER_INTERNAL = createSymbol('register-internal');\r\n\r\nfunction RegisterLoader () {\r\n  Loader.call(this);\r\n\r\n  var registryDelete = this.registry.delete;\r\n  this.registry.delete = function (key) {\r\n    var deleted = registryDelete.call(this, key);\r\n\r\n    // also delete from register registry if linked\r\n    if (records.hasOwnProperty(key) && !records[key].linkRecord) {\r\n      delete records[key];\r\n      deleted = true;\r\n    }\r\n\r\n    return deleted;\r\n  };\r\n\r\n  var records = {};\r\n\r\n  this[REGISTER_INTERNAL] = {\r\n    // last anonymous System.register call\r\n    lastRegister: undefined,\r\n    // in-flight es module load records\r\n    records: records\r\n  };\r\n\r\n  // tracing\r\n  this.trace = false;\r\n}\r\n\r\nRegisterLoader.prototype = Object.create(Loader.prototype);\r\nRegisterLoader.prototype.constructor = RegisterLoader;\r\n\r\nvar INSTANTIATE = RegisterLoader.instantiate = createSymbol('instantiate');\r\n\r\n// default normalize is the WhatWG style normalizer\r\nRegisterLoader.prototype[RegisterLoader.resolve = Loader.resolve] = function (key, parentKey) {\r\n  return resolveIfNotPlain(key, parentKey || baseURI);\r\n};\r\n\r\nRegisterLoader.prototype[INSTANTIATE] = function (key, processAnonRegister) {};\r\n\r\n// once evaluated, the linkRecord is set to undefined leaving just the other load record properties\r\n// this allows tracking new binding listeners for es modules through importerSetters\r\n// for dynamic modules, the load record is removed entirely.\r\nfunction createLoadRecord (state, key, registration) {\r\n  return state.records[key] = {\r\n    key: key,\r\n\r\n    // defined System.register cache\r\n    registration: registration,\r\n\r\n    // module namespace object\r\n    module: undefined,\r\n\r\n    // es-only\r\n    // this sticks around so new module loads can listen to binding changes\r\n    // for already-loaded modules by adding themselves to their importerSetters\r\n    importerSetters: undefined,\r\n\r\n    loadError: undefined,\r\n    evalError: undefined,\r\n\r\n    // in-flight linking record\r\n    linkRecord: {\r\n      // promise for instantiated\r\n      instantiatePromise: undefined,\r\n      dependencies: undefined,\r\n      execute: undefined,\r\n      executingRequire: false,\r\n\r\n      // underlying module object bindings\r\n      moduleObj: undefined,\r\n\r\n      // es only, also indicates if es or not\r\n      setters: undefined,\r\n\r\n      // promise for instantiated dependencies (dependencyInstantiations populated)\r\n      depsInstantiatePromise: undefined,\r\n      // will be the array of dependency load record or a module namespace\r\n      dependencyInstantiations: undefined,\r\n\r\n      // top-level await!\r\n      evaluatePromise: undefined,\r\n\r\n      // NB optimization and way of ensuring module objects in setters\r\n      // indicates setters which should run pre-execution of that dependency\r\n      // setters is then just for completely executed module objects\r\n      // alternatively we just pass the partially filled module objects as\r\n      // arguments into the execute function\r\n      // hoisted: undefined\r\n    }\r\n  };\r\n}\r\n\r\nRegisterLoader.prototype[Loader.resolveInstantiate] = function (key, parentKey) {\r\n  var loader = this;\r\n  var state = this[REGISTER_INTERNAL];\r\n  var registry = this.registry[REGISTRY];\r\n\r\n  return resolveInstantiate(loader, key, parentKey, registry, state)\r\n  .then(function (instantiated) {\r\n    if (instantiated instanceof ModuleNamespace || instantiated[toStringTag] === 'module')\r\n      return instantiated;\r\n\r\n    // resolveInstantiate always returns a load record with a link record and no module value\r\n    var link = instantiated.linkRecord;\r\n\r\n    // if already beaten to done, return\r\n    if (!link) {\r\n      if (instantiated.module)\r\n        return instantiated.module;\r\n      throw instantiated.evalError;\r\n    }\r\n\r\n    return deepInstantiateDeps(loader, instantiated, link, registry, state)\r\n    .then(function () {\r\n      return ensureEvaluate(loader, instantiated, link, registry, state);\r\n    });\r\n  });\r\n};\r\n\r\nfunction resolveInstantiate (loader, key, parentKey, registry, state) {\r\n  // normalization shortpath for already-normalized key\r\n  // could add a plain name filter, but doesn't yet seem necessary for perf\r\n  var module = registry[key];\r\n  if (module)\r\n    return Promise.resolve(module);\r\n\r\n  var load = state.records[key];\r\n\r\n  // already linked but not in main registry is ignored\r\n  if (load && !load.module) {\r\n    if (load.loadError)\r\n      return Promise.reject(load.loadError);\r\n    return instantiate(loader, load, load.linkRecord, registry, state);\r\n  }\r\n\r\n  return loader.resolve(key, parentKey)\r\n  .then(function (resolvedKey) {\r\n    // main loader registry always takes preference\r\n    module = registry[resolvedKey];\r\n    if (module)\r\n      return module;\r\n\r\n    load = state.records[resolvedKey];\r\n\r\n    // already has a module value but not already in the registry (load.module)\r\n    // means it was removed by registry.delete, so we should\r\n    // disgard the current load record creating a new one over it\r\n    // but keep any existing registration\r\n    if (!load || load.module)\r\n      load = createLoadRecord(state, resolvedKey, load && load.registration);\r\n\r\n    if (load.loadError)\r\n      return Promise.reject(load.loadError);\r\n\r\n    var link = load.linkRecord;\r\n    if (!link)\r\n      return load;\r\n\r\n    return instantiate(loader, load, link, registry, state);\r\n  });\r\n}\r\n\r\nfunction createProcessAnonRegister (loader, load, state) {\r\n  return function () {\r\n    var lastRegister = state.lastRegister;\r\n\r\n    if (!lastRegister)\r\n      return !!load.registration;\r\n\r\n    state.lastRegister = undefined;\r\n    load.registration = lastRegister;\r\n\r\n    return true;\r\n  };\r\n}\r\n\r\nfunction instantiate (loader, load, link, registry, state) {\r\n  return link.instantiatePromise || (link.instantiatePromise =\r\n  // if there is already an existing registration, skip running instantiate\r\n  (load.registration ? resolvedPromise : resolvedPromise.then(function () {\r\n    state.lastRegister = undefined;\r\n    return loader[INSTANTIATE](load.key, loader[INSTANTIATE].length > 1 && createProcessAnonRegister(loader, load, state));\r\n  }))\r\n  .then(function (instantiation) {\r\n    // direct module return from instantiate -> we're done\r\n    if (instantiation !== undefined) {\r\n      if (!(instantiation instanceof ModuleNamespace || instantiation[toStringTag] === 'module'))\r\n        throw new TypeError('Instantiate did not return a valid Module object.');\r\n\r\n      delete state.records[load.key];\r\n      if (loader.trace)\r\n        traceLoad(loader, load, link);\r\n      return registry[load.key] = instantiation;\r\n    }\r\n\r\n    // run the cached loader.register declaration if there is one\r\n    var registration = load.registration;\r\n    // clear to allow new registrations for future loads (combined with registry delete)\r\n    load.registration = undefined;\r\n    if (!registration)\r\n      throw new TypeError('Module instantiation did not call an anonymous or correctly named System.register.');\r\n\r\n    link.dependencies = registration[0];\r\n\r\n    load.importerSetters = [];\r\n\r\n    link.moduleObj = {};\r\n\r\n    // process System.registerDynamic declaration\r\n    if (registration[2]) {\r\n      link.moduleObj.default = link.moduleObj.__useDefault = {};\r\n      link.executingRequire = registration[1];\r\n      link.execute = registration[2];\r\n    }\r\n\r\n    // process System.register declaration\r\n    else {\r\n      registerDeclarative(loader, load, link, registration[1]);\r\n    }\r\n\r\n    return load;\r\n  })\r\n  .catch(function (err) {\r\n    load.linkRecord = undefined;\r\n    throw load.loadError = load.loadError || addToError(err, 'Instantiating ' + load.key);\r\n  }));\r\n}\r\n\r\n// like resolveInstantiate, but returning load records for linking\r\nfunction resolveInstantiateDep (loader, key, parentKey, registry, state, traceDepMap) {\r\n  // normalization shortpaths for already-normalized key\r\n  // DISABLED to prioritise consistent resolver calls\r\n  // could add a plain name filter, but doesn't yet seem necessary for perf\r\n  /* var load = state.records[key];\r\n  var module = registry[key];\r\n\r\n  if (module) {\r\n    if (traceDepMap)\r\n      traceDepMap[key] = key;\r\n\r\n    // registry authority check in case module was deleted or replaced in main registry\r\n    if (load && load.module && load.module === module)\r\n      return load;\r\n    else\r\n      return module;\r\n  }\r\n\r\n  // already linked but not in main registry is ignored\r\n  if (load && !load.module) {\r\n    if (traceDepMap)\r\n      traceDepMap[key] = key;\r\n    return instantiate(loader, load, load.linkRecord, registry, state);\r\n  } */\r\n  return loader.resolve(key, parentKey)\r\n  .then(function (resolvedKey) {\r\n    if (traceDepMap)\r\n      traceDepMap[key] = resolvedKey;\r\n\r\n    // normalization shortpaths for already-normalized key\r\n    var load = state.records[resolvedKey];\r\n    var module = registry[resolvedKey];\r\n\r\n    // main loader registry always takes preference\r\n    if (module && (!load || load.module && module !== load.module))\r\n      return module;\r\n\r\n    if (load && load.loadError)\r\n      throw load.loadError;\r\n\r\n    // already has a module value but not already in the registry (load.module)\r\n    // means it was removed by registry.delete, so we should\r\n    // disgard the current load record creating a new one over it\r\n    // but keep any existing registration\r\n    if (!load || !module && load.module)\r\n      load = createLoadRecord(state, resolvedKey, load && load.registration);\r\n\r\n    var link = load.linkRecord;\r\n    if (!link)\r\n      return load;\r\n\r\n    return instantiate(loader, load, link, registry, state);\r\n  });\r\n}\r\n\r\nfunction traceLoad (loader, load, link) {\r\n  loader.loads = loader.loads || {};\r\n  loader.loads[load.key] = {\r\n    key: load.key,\r\n    deps: link.dependencies,\r\n    dynamicDeps: [],\r\n    depMap: link.depMap || {}\r\n  };\r\n}\r\n\r\n/*\r\n * Convert a CJS module.exports into a valid object for new Module:\r\n *\r\n *   new Module(getEsModule(module.exports))\r\n *\r\n * Sets the default value to the module, while also reading off named exports carefully.\r\n */\r\nfunction registerDeclarative (loader, load, link, declare) {\r\n  var moduleObj = link.moduleObj;\r\n  var importerSetters = load.importerSetters;\r\n\r\n  var definedExports = false;\r\n\r\n  // closure especially not based on link to allow link record disposal\r\n  var declared = declare.call(global, function (name, value) {\r\n    if (typeof name === 'object') {\r\n      var changed = false;\r\n      for (var p in name) {\r\n        value = name[p];\r\n        if (p !== '__useDefault' && (!(p in moduleObj) || moduleObj[p] !== value)) {\r\n          changed = true;\r\n          moduleObj[p] = value;\r\n        }\r\n      }\r\n      if (changed === false)\r\n        return value;\r\n    }\r\n    else {\r\n      if ((definedExports || name in moduleObj) && moduleObj[name] === value)\r\n        return value;\r\n      moduleObj[name] = value;\r\n    }\r\n\r\n    for (var i = 0; i < importerSetters.length; i++)\r\n      importerSetters[i](moduleObj);\r\n\r\n    return value;\r\n  }, new ContextualLoader(loader, load.key));\r\n\r\n  link.setters = declared.setters || [];\r\n  link.execute = declared.execute;\r\n  if (declared.exports) {\r\n    link.moduleObj = moduleObj = declared.exports;\r\n    definedExports = true;\r\n  }\r\n}\r\n\r\nfunction instantiateDeps (loader, load, link, registry, state) {\r\n  if (link.depsInstantiatePromise)\r\n    return link.depsInstantiatePromise;\r\n\r\n  var depsInstantiatePromises = Array(link.dependencies.length);\r\n\r\n  for (var i = 0; i < link.dependencies.length; i++)\r\n    depsInstantiatePromises[i] = resolveInstantiateDep(loader, link.dependencies[i], load.key, registry, state, loader.trace && link.depMap || (link.depMap = {}));\r\n\r\n  var depsInstantiatePromise = Promise.all(depsInstantiatePromises)\r\n  .then(function (dependencyInstantiations) {\r\n    link.dependencyInstantiations = dependencyInstantiations;\r\n\r\n    // run setters to set up bindings to instantiated dependencies\r\n    if (link.setters) {\r\n      for (var i = 0; i < dependencyInstantiations.length; i++) {\r\n        var setter = link.setters[i];\r\n        if (setter) {\r\n          var instantiation = dependencyInstantiations[i];\r\n\r\n          if (instantiation instanceof ModuleNamespace || instantiation[toStringTag] === 'module') {\r\n            setter(instantiation);\r\n          }\r\n          else {\r\n            if (instantiation.loadError)\r\n              throw instantiation.loadError;\r\n            setter(instantiation.module || instantiation.linkRecord.moduleObj);\r\n            // this applies to both es and dynamic registrations\r\n            if (instantiation.importerSetters)\r\n              instantiation.importerSetters.push(setter);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return load;\r\n  });\r\n\r\n  if (loader.trace)\r\n    depsInstantiatePromise = depsInstantiatePromise.then(function () {\r\n      traceLoad(loader, load, link);\r\n      return load;\r\n    });\r\n\r\n  depsInstantiatePromise = depsInstantiatePromise.catch(function (err) {\r\n    // throw up the instantiateDeps stack\r\n    link.depsInstantiatePromise = undefined;\r\n    throw addToError(err, 'Loading ' + load.key);\r\n  });\r\n\r\n  depsInstantiatePromise.catch(function () {});\r\n\r\n  return link.depsInstantiatePromise = depsInstantiatePromise;\r\n}\r\n\r\nfunction deepInstantiateDeps (loader, load, link, registry, state) {\r\n  var seen = [];\r\n  function addDeps (load, link) {\r\n    if (!link)\r\n      return resolvedPromise;\r\n    if (seen.indexOf(load) !== -1)\r\n      return resolvedPromise;\r\n    seen.push(load);\r\n    \r\n    return instantiateDeps(loader, load, link, registry, state)\r\n    .then(function () {\r\n      var depPromises;\r\n      for (var i = 0; i < link.dependencies.length; i++) {\r\n        var depLoad = link.dependencyInstantiations[i];\r\n        if (!(depLoad instanceof ModuleNamespace || depLoad[toStringTag] === 'module')) {\r\n          depPromises = depPromises || [];\r\n          depPromises.push(addDeps(depLoad, depLoad.linkRecord));\r\n        }\r\n      }\r\n      if (depPromises)\r\n        return Promise.all(depPromises);\r\n    });\r\n  };\r\n\r\n  return addDeps(load, link);\r\n}\r\n\r\n/*\r\n * System.register\r\n */\r\nRegisterLoader.prototype.register = function (key, deps, declare) {\r\n  var state = this[REGISTER_INTERNAL];\r\n\r\n  // anonymous modules get stored as lastAnon\r\n  if (declare === undefined) {\r\n    state.lastRegister = [key, deps, undefined];\r\n  }\r\n\r\n  // everything else registers into the register cache\r\n  else {\r\n    var load = state.records[key] || createLoadRecord(state, key, undefined);\r\n    load.registration = [deps, declare, undefined];\r\n  }\r\n};\r\n\r\n/*\r\n * System.registerDyanmic\r\n */\r\nRegisterLoader.prototype.registerDynamic = function (key, deps, executingRequire, execute) {\r\n  var state = this[REGISTER_INTERNAL];\r\n\r\n  // anonymous modules get stored as lastAnon\r\n  if (typeof key !== 'string') {\r\n    state.lastRegister = [key, deps, executingRequire];\r\n  }\r\n\r\n  // everything else registers into the register cache\r\n  else {\r\n    var load = state.records[key] || createLoadRecord(state, key, undefined);\r\n    load.registration = [deps, executingRequire, execute];\r\n  }\r\n};\r\n\r\n// ContextualLoader class\r\n// backwards-compatible with previous System.register context argument by exposing .id, .key\r\nfunction ContextualLoader (loader, key) {\r\n  this.loader = loader;\r\n  this.key = this.id = key;\r\n  this.meta = {\r\n    url: key\r\n    // scriptElement: null\r\n  };\r\n}\r\n/*ContextualLoader.prototype.constructor = function () {\r\n  throw new TypeError('Cannot subclass the contextual loader only Reflect.Loader.');\r\n};*/\r\nContextualLoader.prototype.import = function (key) {\r\n  if (this.loader.trace)\r\n    this.loader.loads[this.key].dynamicDeps.push(key);\r\n  return this.loader.import(key, this.key);\r\n};\r\n/*ContextualLoader.prototype.resolve = function (key) {\r\n  return this.loader.resolve(key, this.key);\r\n};*/\r\n\r\nfunction ensureEvaluate (loader, load, link, registry, state) {\r\n  if (load.module)\r\n    return load.module;\r\n  if (load.evalError)\r\n    throw load.evalError;\r\n  if (link.evaluatePromise)\r\n    return link.evaluatePromise;\r\n\r\n  if (link.setters) {\r\n    var evaluatePromise = doEvaluateDeclarative(loader, load, link, registry, state, [load]);\r\n    if (evaluatePromise)\r\n      return evaluatePromise;\r\n  }\r\n  else {\r\n    doEvaluateDynamic(loader, load, link, registry, state, [load]);\r\n  }\r\n  return load.module;\r\n}\r\n\r\nfunction makeDynamicRequire (loader, key, dependencies, dependencyInstantiations, registry, state, seen) {\r\n  // we can only require from already-known dependencies\r\n  return function (name) {\r\n    for (var i = 0; i < dependencies.length; i++) {\r\n      if (dependencies[i] === name) {\r\n        var depLoad = dependencyInstantiations[i];\r\n        var module;\r\n\r\n        if (depLoad instanceof ModuleNamespace || depLoad[toStringTag] === 'module') {\r\n          module = depLoad;\r\n        }\r\n        else {\r\n          if (depLoad.evalError)\r\n            throw depLoad.evalError;\r\n          if (depLoad.module === undefined && seen.indexOf(depLoad) === -1 && !depLoad.linkRecord.evaluatePromise) {\r\n            if (depLoad.linkRecord.setters) {\r\n              doEvaluateDeclarative(loader, depLoad, depLoad.linkRecord, registry, state, [depLoad]);\r\n            }\r\n            else {\r\n              seen.push(depLoad);\r\n              doEvaluateDynamic(loader, depLoad, depLoad.linkRecord, registry, state, seen);\r\n            }\r\n          }\r\n          module = depLoad.module || depLoad.linkRecord.moduleObj;\r\n        }\r\n\r\n        return '__useDefault' in module ? module.__useDefault : module;\r\n      }\r\n    }\r\n    throw new Error('Module ' + name + ' not declared as a System.registerDynamic dependency of ' + key);\r\n  };\r\n}\r\n\r\nfunction evalError (load, err) {\r\n  load.linkRecord = undefined;\r\n  var evalError = addToError(err, 'Evaluating ' + load.key);\r\n  if (load.evalError === undefined)\r\n    load.evalError = evalError;\r\n  throw evalError;\r\n}\r\n\r\n// es modules evaluate dependencies first\r\n// returns the error if any\r\nfunction doEvaluateDeclarative (loader, load, link, registry, state, seen) {\r\n  var depLoad, depLink;\r\n  var depLoadPromises;\r\n  for (var i = 0; i < link.dependencies.length; i++) {\r\n    var depLoad = link.dependencyInstantiations[i];\r\n    if (depLoad instanceof ModuleNamespace || depLoad[toStringTag] === 'module')\r\n      continue;\r\n\r\n    // custom Module returned from instantiate\r\n    depLink = depLoad.linkRecord;\r\n    if (depLink) {\r\n      if (depLoad.evalError) {\r\n        evalError(load, depLoad.evalError);\r\n      }\r\n      else if (depLink.setters) {\r\n        if (seen.indexOf(depLoad) === -1) {\r\n          seen.push(depLoad);\r\n          try {\r\n            var depLoadPromise = doEvaluateDeclarative(loader, depLoad, depLink, registry, state, seen);\r\n          }\r\n          catch (e) {\r\n            evalError(load, e);\r\n          }\r\n          if (depLoadPromise) {\r\n            depLoadPromises = depLoadPromises || [];\r\n            depLoadPromises.push(depLoadPromise.catch(function (err) {\r\n              evalError(load, err);\r\n            }));\r\n          }\r\n        }\r\n      }\r\n      else {\r\n        try {\r\n          doEvaluateDynamic(loader, depLoad, depLink, registry, state, [depLoad]);\r\n        }\r\n        catch (e) {\r\n          evalError(load, e);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  if (depLoadPromises)\r\n    return link.evaluatePromise = Promise.all(depLoadPromises)\r\n    .then(function () {\r\n      if (link.execute) {\r\n        // ES System.register execute\r\n        // \"this\" is null in ES\r\n        try {\r\n          var execPromise = link.execute.call(nullContext);\r\n        }\r\n        catch (e) {\r\n          evalError(load, e);\r\n        }\r\n        if (execPromise)\r\n          return execPromise.catch(function (e) {\r\n            evalError(load, e);\r\n          })\r\n          .then(function () {\r\n            load.linkRecord = undefined;\r\n            return registry[load.key] = load.module = new ModuleNamespace(link.moduleObj);\r\n          });\r\n      }\r\n    \r\n      // dispose link record\r\n      load.linkRecord = undefined;\r\n      registry[load.key] = load.module = new ModuleNamespace(link.moduleObj);\r\n    });\r\n\r\n  if (link.execute) {\r\n    // ES System.register execute\r\n    // \"this\" is null in ES\r\n    try {\r\n      var execPromise = link.execute.call(nullContext);\r\n    }\r\n    catch (e) {\r\n      evalError(load, e);\r\n    }\r\n    if (execPromise)\r\n      return link.evaluatePromise = execPromise.catch(function (e) {\r\n        evalError(load, e);\r\n      })\r\n      .then(function () {\r\n        load.linkRecord = undefined;\r\n        return registry[load.key] = load.module = new ModuleNamespace(link.moduleObj);\r\n      });\r\n  }\r\n\r\n  // dispose link record\r\n  load.linkRecord = undefined;\r\n  registry[load.key] = load.module = new ModuleNamespace(link.moduleObj);\r\n}\r\n\r\n// non es modules explicitly call moduleEvaluate through require\r\nfunction doEvaluateDynamic (loader, load, link, registry, state, seen) {\r\n  // System.registerDynamic execute\r\n  // \"this\" is \"exports\" in CJS\r\n  var module = { id: load.key };\r\n  var moduleObj = link.moduleObj;\r\n  Object.defineProperty(module, 'exports', {\r\n    configurable: true,\r\n    set: function (exports) {\r\n      moduleObj.default = moduleObj.__useDefault = exports;\r\n    },\r\n    get: function () {\r\n      return moduleObj.__useDefault;\r\n    }\r\n  });\r\n\r\n  var require = makeDynamicRequire(loader, load.key, link.dependencies, link.dependencyInstantiations, registry, state, seen);\r\n\r\n  // evaluate deps first\r\n  if (!link.executingRequire)\r\n    for (var i = 0; i < link.dependencies.length; i++)\r\n      require(link.dependencies[i]);\r\n\r\n  try {\r\n    var output = link.execute.call(global, require, moduleObj.default, module);\r\n    if (output !== undefined)\r\n      module.exports = output;\r\n  }\r\n  catch (e) {\r\n    evalError(load, e);\r\n  }\r\n\r\n  load.linkRecord = undefined;\r\n\r\n  // pick up defineProperty calls to module.exports when we can\r\n  if (module.exports !== moduleObj.__useDefault)\r\n    moduleObj.default = moduleObj.__useDefault = module.exports;\r\n\r\n  var moduleDefault = moduleObj.default;\r\n\r\n  // __esModule flag extension support via lifting\r\n  if (moduleDefault && moduleDefault.__esModule) {\r\n    for (var p in moduleDefault) {\r\n      if (Object.hasOwnProperty.call(moduleDefault, p))\r\n        moduleObj[p] = moduleDefault[p];\r\n    }\r\n  }\r\n\r\n  registry[load.key] = load.module = new ModuleNamespace(link.moduleObj);\r\n\r\n  // run importer setters and clear them\r\n  // this allows dynamic modules to update themselves into es modules\r\n  // as soon as execution has completed\r\n  if (load.importerSetters)\r\n    for (var i = 0; i < load.importerSetters.length; i++)\r\n      load.importerSetters[i](load.module);\r\n  load.importerSetters = undefined;\r\n}\r\n\r\n// the closest we can get to call(undefined)\r\nvar nullContext = Object.create(null);\r\nif (Object.freeze)\r\n  Object.freeze(nullContext);\r\n","import { resolveIfNotPlain } from 'es-module-loader/core/resolve.js';\r\nimport { baseURI, isBrowser, isWindows, addToError, global, createSymbol, toStringTag } from 'es-module-loader/core/common.js';\r\nimport RegisterLoader from 'es-module-loader/core/register-loader.js';\r\nimport { ModuleNamespace } from 'es-module-loader/core/loader-polyfill.js';\r\n\r\nexport { baseURI, isBrowser, isWindows, addToError, global, resolveIfNotPlain, ModuleNamespace }\r\n\r\nexport var resolvedPromise = Promise.resolve();\r\nexport function noop () {};\r\n\r\nexport var emptyModule = new ModuleNamespace({});\r\n\r\nexport function protectedCreateNamespace (bindings) {\r\n  if (bindings) {\r\n    if (bindings instanceof ModuleNamespace || bindings[toStringTag] === 'module')\r\n      return bindings;\r\n\r\n    if (bindings.__esModule)\r\n      return new ModuleNamespace(bindings);\r\n  }\r\n\r\n  return new ModuleNamespace({ default: bindings, __useDefault: bindings });\r\n}\r\n\r\nexport function isModule (m) {\r\n  return m instanceof ModuleNamespace || m[toStringTag] === 'module';\r\n}\r\n\r\nexport var CONFIG = createSymbol('loader-config');\r\nexport var METADATA = createSymbol('metadata');\r\nexport var PLAIN_RESOLVE = createSymbol('plain-resolve');\r\nexport var PLAIN_RESOLVE_SYNC = createSymbol('plain-resolve-sync');\r\n\r\nexport var isWorker = typeof window === 'undefined' && typeof self !== 'undefined' && typeof importScripts !== 'undefined';\r\n\r\nexport function warn (msg, force) {\r\n  if (force || this.warnings && typeof console !== 'undefined' && console.warn)\r\n    console.warn(msg);\r\n}\r\n\r\nexport function checkInstantiateWasm (loader, wasmBuffer, processAnonRegister) {\r\n  var bytes = new Uint8Array(wasmBuffer);\r\n\r\n  // detect by leading bytes\r\n  // Can be (new Uint32Array(fetched))[0] === 0x6D736100 when working in Node\r\n  if (bytes[0] === 0 && bytes[1] === 97 && bytes[2] === 115) {\r\n    return WebAssembly.compile(wasmBuffer).then(function (m) {\r\n      var deps = [];\r\n      var setters = [];\r\n      var importObj = {};\r\n\r\n      // we can only set imports if supported (eg Safari doesnt support)\r\n      if (WebAssembly.Module.imports)\r\n        WebAssembly.Module.imports(m).forEach(function (i) {\r\n          var key = i.module;\r\n          setters.push(function (m) {\r\n            importObj[key] = m;\r\n          });\r\n          if (deps.indexOf(key) === -1)\r\n            deps.push(key);\r\n        });\r\n      loader.register(deps, function (_export) {\r\n        return {\r\n          setters: setters,\r\n          execute: function () {\r\n            _export(new WebAssembly.Instance(m, importObj).exports);\r\n          }\r\n        };\r\n      });\r\n      processAnonRegister();\r\n\r\n      return true;\r\n    });\r\n  }\r\n\r\n  return Promise.resolve(false);\r\n}\r\n\r\nvar parentModuleContext;\r\nexport function loadNodeModule (key, baseURL) {\r\n  if (key[0] === '.')\r\n    throw new Error('Node module ' + key + ' can\\'t be loaded as it is not a package require.');\r\n\r\n  if (!parentModuleContext) {\r\n    var Module = this._nodeRequire('module');\r\n    var base = decodeURI(baseURL.substr(isWindows ? 8 : 7));\r\n    parentModuleContext = new Module(base);\r\n    parentModuleContext.paths = Module._nodeModulePaths(base);\r\n  }\r\n  return parentModuleContext.require(key);\r\n}\r\n\r\nexport function extend (a, b) {\r\n  for (var p in b) {\r\n    if (!Object.hasOwnProperty.call(b, p))\r\n      continue;\r\n    a[p] = b[p];\r\n  }\r\n  return a;\r\n}\r\n\r\nexport function prepend (a, b) {\r\n  for (var p in b) {\r\n    if (!Object.hasOwnProperty.call(b, p))\r\n      continue;\r\n    if (a[p] === undefined)\r\n      a[p] = b[p];\r\n  }\r\n  return a;\r\n}\r\n\r\n// meta first-level extends where:\r\n// array + array appends\r\n// object + object extends\r\n// other properties replace\r\nexport function extendMeta (a, b, _prepend) {\r\n  for (var p in b) {\r\n    if (!Object.hasOwnProperty.call(b, p))\r\n      continue;\r\n    var val = b[p];\r\n    if (a[p] === undefined)\r\n      a[p] = val;\r\n    else if (val instanceof Array && a[p] instanceof Array)\r\n      a[p] = [].concat(_prepend ? val : a[p]).concat(_prepend ? a[p] : val);\r\n    else if (typeof val == 'object' && val !== null && typeof a[p] == 'object')\r\n      a[p] = (_prepend ? prepend : extend)(extend({}, a[p]), val);\r\n    else if (!_prepend)\r\n      a[p] = val;\r\n  }\r\n}\r\n\r\nvar supportsPreload = false, supportsPrefetch = false;\r\nif (isBrowser)\r\n  (function () {\r\n    var relList = document.createElement('link').relList;\r\n    if (relList && relList.supports) {\r\n      supportsPrefetch = true;\r\n      try {\r\n        supportsPreload = relList.supports('preload');\r\n      }\r\n      catch (e) {}\r\n    }\r\n  })();\r\n\r\nexport function preloadScript (url) {\r\n  // fallback to old fashioned image technique which still works in safari\r\n  if (!supportsPreload && !supportsPrefetch) {\r\n    var preloadImage = new Image();\r\n    preloadImage.src = url;\r\n    return;\r\n  }\r\n\r\n  var link = document.createElement('link');\r\n  if (supportsPreload) {\r\n    link.rel = 'preload';\r\n    link.as = 'script';\r\n  }\r\n  else {\r\n    // this works for all except Safari (detected by relList.supports lacking)\r\n    link.rel = 'prefetch';\r\n  }\r\n  link.href = url;\r\n  document.head.appendChild(link);\r\n}\r\n\r\nfunction workerImport (src, resolve, reject) {\r\n  try {\r\n    importScripts(src);\r\n  }\r\n  catch (e) {\r\n    reject(e);\r\n  }\r\n  resolve();\r\n}\r\n\r\nif (isBrowser) {\r\n  var onerror = window.onerror;\r\n  window.onerror = function globalOnerror (msg, src) {\r\n    if (onerror)\r\n      onerror.apply(this, arguments);\r\n  };\r\n}\r\n\r\nexport function scriptLoad (src, crossOrigin, integrity, resolve, reject) {\r\n  // percent encode just \"#\" for HTTP requests\r\n  src = src.replace(/#/g, '%23');\r\n\r\n  // subresource integrity is not supported in web workers\r\n  if (isWorker)\r\n    return workerImport(src, resolve, reject);\r\n\r\n  var script = document.createElement('script');\r\n  script.type = 'text/javascript';\r\n  script.charset = 'utf-8';\r\n  script.async = true;\r\n\r\n  if (crossOrigin)\r\n    script.crossOrigin = crossOrigin;\r\n  if (integrity)\r\n    script.integrity = integrity;\r\n\r\n  script.addEventListener('load', load, false);\r\n  script.addEventListener('error', error, false);\r\n\r\n  script.src = src;\r\n  document.head.appendChild(script);\r\n\r\n  function load () {\r\n    resolve();\r\n    cleanup();\r\n  }\r\n\r\n  // note this does not catch execution errors\r\n  function error (err) {\r\n    cleanup();\r\n    reject(new Error('Fetching ' + src));\r\n  }\r\n\r\n  function cleanup () {\r\n    script.removeEventListener('load', load, false);\r\n    script.removeEventListener('error', error, false);\r\n    document.head.removeChild(script);\r\n  }\r\n}\r\n\r\nexport function readMemberExpression (p, value) {\r\n  var pParts = p.split('.');\r\n  while (pParts.length)\r\n    value = value[pParts.shift()];\r\n  return value;\r\n}\r\n\r\n// separate out paths cache as a baseURL lock process\r\nexport function applyPaths (baseURL, paths, key) {\r\n  var mapMatch = getMapMatch(paths, key);\r\n  if (mapMatch) {\r\n    var target = paths[mapMatch] + key.substr(mapMatch.length);\r\n\r\n    var resolved = resolveIfNotPlain(target, baseURI);\r\n    if (resolved !== undefined)\r\n      return resolved;\r\n\r\n    return baseURL + target;\r\n  }\r\n  else if (key.indexOf(':') !== -1) {\r\n    return key;\r\n  }\r\n  else {\r\n    return baseURL + key;\r\n  }\r\n}\r\n\r\nfunction checkMap (p) {\r\n  var name = this.name;\r\n  // can add ':' here if we want paths to match the behaviour of map\r\n  if (name.substr(0, p.length) === p && (name.length === p.length || name[p.length] === '/' || p[p.length - 1] === '/' || p[p.length - 1] === ':')) {\r\n    var curLen = p.split('/').length;\r\n    if (curLen > this.len) {\r\n      this.match = p;\r\n      this.len = curLen;\r\n    }\r\n  }\r\n}\r\n\r\nexport function getMapMatch (map, name) {\r\n  if (Object.hasOwnProperty.call(map, name))\r\n    return name;\r\n\r\n  var bestMatch = {\r\n    name: name,\r\n    match: undefined,\r\n    len: 0\r\n  };\r\n\r\n  Object.keys(map).forEach(checkMap, bestMatch);\r\n\r\n  return bestMatch.match;\r\n}\r\n\r\n// RegEx adjusted from https://github.com/jbrantly/yabble/blob/master/lib/yabble.js#L339\r\nexport var cjsRequireRegEx = /(?:^\\uFEFF?|[^$_a-zA-Z\\xA0-\\uFFFF.\"'])require\\s*\\(\\s*(\"[^\"\\\\]*(?:\\\\.[^\"\\\\]*)*\"|'[^'\\\\]*(?:\\\\.[^'\\\\]*)*'|`[^`\\\\]*(?:\\\\.[^`\\\\]*)*`)\\s*\\)/g\r\n","import { isWindows } from './common.js';\r\n\r\n/*\r\n * Source loading\r\n */\r\nfunction fetchFetch (url, authorization, integrity, asBuffer) {\r\n  // fetch doesn't support file:/// urls\r\n  if (url.substr(0, 8) === 'file:///') {\r\n    if (hasXhr)\r\n      return xhrFetch(url, authorization, integrity, asBuffer);\r\n    else\r\n      throw new Error('Unable to fetch file URLs in this environment.');\r\n  }\r\n\r\n  // percent encode just \"#\" for HTTP requests\r\n  url = url.replace(/#/g, '%23');\r\n\r\n  var opts = {\r\n    // NB deprecate\r\n    headers: { Accept: 'application/x-es-module, */*' }\r\n  };\r\n\r\n  if (integrity)\r\n    opts.integrity = integrity;\r\n\r\n  if (authorization) {\r\n    if (typeof authorization == 'string')\r\n      opts.headers['Authorization'] = authorization;\r\n    opts.credentials = 'include';\r\n  }\r\n\r\n  return fetch(url, opts)\r\n  .then(function(res) {\r\n    if (res.ok)\r\n      return asBuffer ? res.arrayBuffer() : res.text();\r\n    else\r\n      throw new Error('Fetch error: ' + res.status + ' ' + res.statusText);\r\n  });\r\n}\r\n\r\nfunction xhrFetch (url, authorization, integrity, asBuffer) {\r\n  return new Promise(function (resolve, reject) {\r\n    // percent encode just \"#\" for HTTP requests\r\n    url = url.replace(/#/g, '%23');\r\n\r\n    var xhr = new XMLHttpRequest();\r\n    if (asBuffer)\r\n      xhr.responseType = 'arraybuffer';\r\n    function load() {\r\n      resolve(asBuffer ? xhr.response : xhr.responseText);\r\n    }\r\n    function error() {\r\n      reject(new Error('XHR error: ' + (xhr.status ? ' (' + xhr.status + (xhr.statusText ? ' ' + xhr.statusText  : '') + ')' : '') + ' loading ' + url));\r\n    }\r\n\r\n    xhr.onreadystatechange = function () {\r\n      if (xhr.readyState === 4) {\r\n        // in Chrome on file:/// URLs, status is 0\r\n        if (xhr.status == 0) {\r\n          if (xhr.response) {\r\n            load();\r\n          }\r\n          else {\r\n            // when responseText is empty, wait for load or error event\r\n            // to inform if it is a 404 or empty file\r\n            xhr.addEventListener('error', error);\r\n            xhr.addEventListener('load', load);\r\n          }\r\n        }\r\n        else if (xhr.status === 200) {\r\n          load();\r\n        }\r\n        else {\r\n          error();\r\n        }\r\n      }\r\n    };\r\n    xhr.open(\"GET\", url, true);\r\n\r\n    if (xhr.setRequestHeader) {\r\n      xhr.setRequestHeader('Accept', 'application/x-es-module, */*');\r\n      // can set \"authorization: true\" to enable withCredentials only\r\n      if (authorization) {\r\n        if (typeof authorization == 'string')\r\n          xhr.setRequestHeader('Authorization', authorization);\r\n        xhr.withCredentials = true;\r\n      }\r\n    }\r\n\r\n    xhr.send(null);\r\n  });\r\n}\r\n\r\nvar fs;\r\nfunction nodeFetch (url, authorization, integrity, asBuffer) {\r\n  if (url.substr(0, 8) != 'file:///') {\r\n    if (hasFetch)\r\n      return fetchFetch(url, authorization, integrity, asBuffer);\r\n    else\r\n      return Promise.reject(new Error('Unable to fetch \"' + url + '\". Only file URLs of the form file:/// supported running in Node without fetch.'));\r\n  }\r\n  \r\n  fs = fs || require('fs');\r\n  if (isWindows)\r\n    url = url.replace(/\\//g, '\\\\').substr(8);\r\n  else\r\n    url = url.substr(7);\r\n\r\n  return new Promise(function (resolve, reject) {\r\n    fs.readFile(url, function(err, data) {\r\n      if (err) {\r\n        return reject(err);\r\n      }\r\n      else {\r\n        if (asBuffer) {\r\n          resolve(data);\r\n        }\r\n        else {\r\n          // Strip Byte Order Mark out if it's the leading char\r\n          var dataString = data + '';\r\n          if (dataString[0] === '\\ufeff')\r\n            dataString = dataString.substr(1);\r\n\r\n          resolve(dataString);\r\n        }\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nfunction noFetch () {\r\n  throw new Error('No fetch method is defined for this environment.');\r\n}\r\n\r\nvar fetchFunction;\r\n\r\nvar hasXhr = typeof XMLHttpRequest !== 'undefined';\r\nvar hasFetch = typeof fetch !== 'undefined';\r\n\r\nif (typeof self !== 'undefined' && typeof self.fetch !== 'undefined')\r\n fetchFunction = fetchFetch;\r\nelse if (hasXhr)\r\n  fetchFunction = xhrFetch;\r\nelse if (typeof require !== 'undefined' && typeof process !== 'undefined')\r\n  fetchFunction = nodeFetch;\r\nelse\r\n  fetchFunction = noFetch;\r\n\r\nexport default fetchFunction;\r\n","import RegisterLoader from 'es-module-loader/core/register-loader.js';\r\nimport { getMapMatch, readMemberExpression, extendMeta, addToError, resolveIfNotPlain,\r\n    baseURI, CONFIG, METADATA, applyPaths, resolvedPromise, getPackage } from './common.js';\r\nimport { setPkgConfig, createPackage } from './config.js';\r\nimport fetch from './fetch.js';\r\n\r\nexport function createMetadata () {\r\n  return {\r\n    pluginKey: undefined,\r\n    pluginArgument: undefined,\r\n    pluginModule: undefined,\r\n    packageKey: undefined,\r\n    packageConfig: undefined,\r\n    load: undefined\r\n  };\r\n}\r\n\r\nfunction getCoreParentMetadata (loader, config, parentKey) {\r\n  var parentMetadata = createMetadata();\r\n\r\n  if (parentKey) {\r\n    // detect parent plugin\r\n    // we just need pluginKey to be truthy for package configurations\r\n    // so we duplicate it as pluginArgument - although not correct its not used\r\n    var parentPluginIndex;\r\n    if (config.pluginFirst) {\r\n      if ((parentPluginIndex = parentKey.lastIndexOf('!')) !== -1)\r\n        parentMetadata.pluginArgument = parentMetadata.pluginKey = parentKey.substr(0, parentPluginIndex);\r\n    }\r\n    else {\r\n      if ((parentPluginIndex = parentKey.indexOf('!')) !== -1)\r\n        parentMetadata.pluginArgument = parentMetadata.pluginKey = parentKey.substr(parentPluginIndex + 1);\r\n    }\r\n  }\r\n\r\n  return parentMetadata;\r\n}\r\n\r\nfunction getParentMetadata (loader, config, parentKey) {\r\n  var parentMetadata = createMetadata();\r\n\r\n  if (parentKey) {\r\n    // detect parent plugin\r\n    // we just need pluginKey to be truthy for package configurations\r\n    // so we duplicate it as pluginArgument - although not correct its not used\r\n    var parentPluginIndex;\r\n    if (config.pluginFirst) {\r\n      if ((parentPluginIndex = parentKey.lastIndexOf('!')) !== -1)\r\n        parentMetadata.pluginArgument = parentMetadata.pluginKey = parentKey.substr(0, parentPluginIndex);\r\n    }\r\n    else {\r\n      if ((parentPluginIndex = parentKey.indexOf('!')) !== -1)\r\n        parentMetadata.pluginArgument = parentMetadata.pluginKey = parentKey.substr(parentPluginIndex + 1);\r\n    }\r\n\r\n    // detect parent package\r\n    parentMetadata.packageKey = getMapMatch(config.packages, parentKey);\r\n    if (parentMetadata.packageKey)\r\n      parentMetadata.packageConfig = config.packages[parentMetadata.packageKey];\r\n  }\r\n\r\n  return parentMetadata;\r\n}\r\n\r\nexport function normalize (key, parentKey) {\r\n  var config = this[CONFIG];\r\n\r\n  var metadata = createMetadata();\r\n  var parentMetadata = getParentMetadata(this, config, parentKey);\r\n\r\n  var loader = this;\r\n\r\n  return Promise.resolve()\r\n\r\n  // boolean conditional\r\n  .then(function () {\r\n    // first we normalize the conditional\r\n    var booleanIndex = key.lastIndexOf('#?');\r\n\r\n    if (booleanIndex === -1)\r\n      return Promise.resolve(key);\r\n\r\n    var conditionObj = parseCondition.call(loader, key.substr(booleanIndex + 2));\r\n\r\n    // in builds, return normalized conditional\r\n    /*if (this.builder)\r\n      return this.resolve(conditionObj.module, parentKey)\r\n      .then(function (conditionModule) {\r\n        conditionObj.module = conditionModule;\r\n        return key.substr(0, booleanIndex) + '#?' + serializeCondition(conditionObj);\r\n      });*/\r\n\r\n    return resolveCondition.call(loader, conditionObj, parentKey, true)\r\n    .then(function (conditionValue) {\r\n      return conditionValue ? key.substr(0, booleanIndex) : '@empty';\r\n    });\r\n  })\r\n\r\n  // plugin\r\n  .then(function (key) {\r\n    var parsed = parsePlugin(config.pluginFirst, key);\r\n\r\n    if (!parsed)\r\n      return packageResolve.call(loader, config, key, parentMetadata && parentMetadata.pluginArgument || parentKey, metadata, parentMetadata, false);\r\n\r\n    metadata.pluginKey = parsed.plugin;\r\n\r\n    return Promise.all([\r\n      packageResolve.call(loader, config, parsed.argument, parentMetadata && parentMetadata.pluginArgument || parentKey, metadata, parentMetadata, true),\r\n      loader.resolve(parsed.plugin, parentKey)\r\n    ])\r\n    .then(function (normalized) {\r\n      metadata.pluginArgument = normalized[0];\r\n      metadata.pluginKey = normalized[1];\r\n\r\n      // don't allow a plugin to load itself\r\n      if (metadata.pluginArgument === metadata.pluginKey)\r\n        throw new Error('Plugin ' + metadata.pluginArgument + ' cannot load itself, make sure it is excluded from any wildcard meta configuration via a custom loader: false rule.');\r\n\r\n      return combinePluginParts(config.pluginFirst, normalized[0], normalized[1]);\r\n    });\r\n  })\r\n  .then(function (normalized) {\r\n    return interpolateConditional.call(loader, normalized, parentKey, parentMetadata);\r\n  })\r\n  .then(function (normalized) {\r\n    setMeta.call(loader, config, normalized, metadata);\r\n\r\n    if (metadata.pluginKey || !metadata.load.loader)\r\n      return normalized;\r\n\r\n    // loader by configuration\r\n    // normalizes to parent to support package loaders\r\n    return loader.resolve(metadata.load.loader, normalized)\r\n    .then(function (pluginKey) {\r\n      metadata.pluginKey = pluginKey;\r\n      metadata.pluginArgument = normalized;\r\n      return normalized;\r\n    });\r\n  })\r\n  .then(function (normalized) {\r\n    loader[METADATA][normalized] = metadata;\r\n    return normalized;\r\n  });\r\n}\r\n\r\n// normalization function used for registry keys\r\n// just does coreResolve without map\r\nexport function decanonicalize (config, key) {\r\n  var parsed = parsePlugin(config.pluginFirst, key);\r\n\r\n  // plugin\r\n  if (parsed) {\r\n    var pluginKey = decanonicalize.call(this, config, parsed.plugin);\r\n    return combinePluginParts(config.pluginFirst, coreResolve.call(this, config, parsed.argument, undefined, false, false), pluginKey);\r\n  }\r\n\r\n  return coreResolve.call(this, config, key, undefined, false, false);\r\n}\r\n\r\nexport function normalizeSync (key, parentKey) {\r\n  var config = this[CONFIG];\r\n\r\n  // normalizeSync is metadataless, so create metadata\r\n  var metadata = createMetadata();\r\n  var parentMetadata = parentMetadata || getParentMetadata(this, config, parentKey);\r\n\r\n  var parsed = parsePlugin(config.pluginFirst, key);\r\n\r\n  // plugin\r\n  if (parsed) {\r\n    metadata.pluginKey = normalizeSync.call(this, parsed.plugin, parentKey);\r\n    return combinePluginParts(config.pluginFirst,\r\n        packageResolveSync.call(this, config, parsed.argument, parentMetadata.pluginArgument || parentKey, metadata, parentMetadata, !!metadata.pluginKey),\r\n        metadata.pluginKey);\r\n  }\r\n\r\n  return packageResolveSync.call(this, config, key, parentMetadata.pluginArgument || parentKey, metadata, parentMetadata, !!metadata.pluginKey);\r\n}\r\n\r\nexport function coreResolve (config, key, parentKey, doMap, packageName) {\r\n  var relativeResolved = resolveIfNotPlain(key, parentKey || baseURI);\r\n\r\n  // standard URL resolution\r\n  if (relativeResolved)\r\n    return applyPaths(config.baseURL, config.paths, relativeResolved);\r\n\r\n  // plain keys not starting with './', 'x://' and '/' go through custom resolution\r\n  if (doMap) {\r\n    var mapMatch = getMapMatch(config.map, key);\r\n\r\n    if (mapMatch) {\r\n      key = config.map[mapMatch] + key.substr(mapMatch.length);\r\n\r\n      relativeResolved = resolveIfNotPlain(key, baseURI);\r\n      if (relativeResolved)\r\n        return applyPaths(config.baseURL, config.paths, relativeResolved);\r\n    }\r\n  }\r\n\r\n  if (this.registry.has(key))\r\n    return key;\r\n\r\n  if (key.substr(0, 6) === '@node/')\r\n    return key;\r\n\r\n  var trailingSlash = packageName && key[key.length - 1] !== '/';\r\n  var resolved = applyPaths(config.baseURL, config.paths, trailingSlash ? key + '/' : key);\r\n  if (trailingSlash)\r\n    return resolved.substr(0, resolved.length - 1);\r\n  return resolved;\r\n}\r\n\r\nfunction packageResolveSync (config, key, parentKey, metadata, parentMetadata, skipExtensions) {\r\n  // ignore . since internal maps handled by standard package resolution\r\n  if (parentMetadata && parentMetadata.packageConfig && key[0] !== '.') {\r\n    var parentMap = parentMetadata.packageConfig.map;\r\n    var parentMapMatch = parentMap && getMapMatch(parentMap, key);\r\n\r\n    if (parentMapMatch && typeof parentMap[parentMapMatch] === 'string') {\r\n      var mapped = doMapSync(this, config, parentMetadata.packageConfig, parentMetadata.packageKey, parentMapMatch, key, metadata, skipExtensions);\r\n      if (mapped)\r\n        return mapped;\r\n    }\r\n  }\r\n\r\n  var normalized = coreResolve.call(this, config, key, parentKey, true, true);\r\n\r\n  var pkgConfigMatch = getPackageConfigMatch(config, normalized);\r\n  metadata.packageKey = pkgConfigMatch && pkgConfigMatch.packageKey || getMapMatch(config.packages, normalized);\r\n\r\n  if (!metadata.packageKey)\r\n    return normalized;\r\n\r\n  if (config.packageConfigKeys.indexOf(normalized) !== -1) {\r\n    metadata.packageKey = undefined;\r\n    return normalized;\r\n  }\r\n\r\n  metadata.packageConfig = config.packages[metadata.packageKey] || (config.packages[metadata.packageKey] = createPackage());\r\n\r\n  var subPath = normalized.substr(metadata.packageKey.length + 1);\r\n\r\n  return applyPackageConfigSync(this, config, metadata.packageConfig, metadata.packageKey, subPath, metadata, skipExtensions);\r\n}\r\n\r\nfunction packageResolve (config, key, parentKey, metadata, parentMetadata, skipExtensions) {\r\n  var loader = this;\r\n\r\n  return resolvedPromise\r\n  .then(function () {\r\n    // ignore . since internal maps handled by standard package resolution\r\n    if (parentMetadata && parentMetadata.packageConfig && key.substr(0, 2) !== './') {\r\n      var parentMap = parentMetadata.packageConfig.map;\r\n      var parentMapMatch = parentMap && getMapMatch(parentMap, key);\r\n\r\n      if (parentMapMatch)\r\n        return doMap(loader, config, parentMetadata.packageConfig, parentMetadata.packageKey, parentMapMatch, key, metadata, skipExtensions);\r\n    }\r\n\r\n    return resolvedPromise;\r\n  })\r\n  .then(function (mapped) {\r\n    if (mapped)\r\n      return mapped;\r\n\r\n    // apply map, core, paths, contextual package map\r\n    var normalized = coreResolve.call(loader, config, key, parentKey, true, true);\r\n\r\n    var pkgConfigMatch = getPackageConfigMatch(config, normalized);\r\n    metadata.packageKey = pkgConfigMatch && pkgConfigMatch.packageKey || getMapMatch(config.packages, normalized);\r\n\r\n    if (!metadata.packageKey)\r\n      return Promise.resolve(normalized);\r\n\r\n    if (config.packageConfigKeys.indexOf(normalized) !== -1) {\r\n      metadata.packageKey = undefined;\r\n      metadata.load = createMeta();\r\n      metadata.load.format = 'json';\r\n      // ensure no loader\r\n      metadata.load.loader = '';\r\n      return Promise.resolve(normalized);\r\n    }\r\n\r\n    metadata.packageConfig = config.packages[metadata.packageKey] || (config.packages[metadata.packageKey] = createPackage());\r\n\r\n    // load configuration when it matches packageConfigPaths, not already configured, and not the config itself\r\n    var loadConfig = pkgConfigMatch && !metadata.packageConfig.configured;\r\n\r\n    return (loadConfig ? loadPackageConfigPath(loader, config, pkgConfigMatch.configPath, metadata) : resolvedPromise)\r\n    .then(function () {\r\n      var subPath = normalized.substr(metadata.packageKey.length + 1);\r\n\r\n      return applyPackageConfig(loader, config, metadata.packageConfig, metadata.packageKey, subPath, metadata, skipExtensions);\r\n    });\r\n  });\r\n}\r\n\r\nfunction createMeta () {\r\n  return {\r\n    extension: '',\r\n    deps: undefined,\r\n    format: undefined,\r\n    loader: undefined,\r\n    scriptLoad: undefined,\r\n    globals: undefined,\r\n    nonce: undefined,\r\n    integrity: undefined,\r\n    sourceMap: undefined,\r\n    exports: undefined,\r\n    encapsulateGlobal: false,\r\n    crossOrigin: undefined,\r\n    cjsRequireDetection: true,\r\n    cjsDeferDepsExecute: false,\r\n    esModule: false\r\n  };\r\n}\r\n\r\nfunction setMeta (config, key, metadata) {\r\n  metadata.load = metadata.load || createMeta();\r\n\r\n  // apply wildcard metas\r\n  var bestDepth = 0;\r\n  var wildcardIndex;\r\n  for (var module in config.meta) {\r\n    wildcardIndex = module.indexOf('*');\r\n    if (wildcardIndex === -1)\r\n      continue;\r\n    if (module.substr(0, wildcardIndex) === key.substr(0, wildcardIndex)\r\n        && module.substr(wildcardIndex + 1) === key.substr(key.length - module.length + wildcardIndex + 1)) {\r\n      var depth = module.split('/').length;\r\n      if (depth > bestDepth)\r\n        bestDepth = depth;\r\n      extendMeta(metadata.load, config.meta[module], bestDepth !== depth);\r\n    }\r\n  }\r\n\r\n  // apply exact meta\r\n  if (config.meta[key])\r\n    extendMeta(metadata.load, config.meta[key], false);\r\n\r\n  // apply package meta\r\n  if (metadata.packageKey) {\r\n    var subPath = key.substr(metadata.packageKey.length + 1);\r\n\r\n    var meta = {};\r\n    if (metadata.packageConfig.meta) {\r\n      var bestDepth = 0;\r\n      getMetaMatches(metadata.packageConfig.meta, subPath, function (metaPattern, matchMeta, matchDepth) {\r\n        if (matchDepth > bestDepth)\r\n          bestDepth = matchDepth;\r\n        extendMeta(meta, matchMeta, matchDepth && bestDepth > matchDepth);\r\n      });\r\n\r\n      extendMeta(metadata.load, meta, false);\r\n    }\r\n\r\n    // format\r\n    if (metadata.packageConfig.format && !metadata.pluginKey && !metadata.load.loader)\r\n      metadata.load.format = metadata.load.format || metadata.packageConfig.format;\r\n  }\r\n}\r\n\r\nfunction parsePlugin (pluginFirst, key) {\r\n  var argumentKey;\r\n  var pluginKey;\r\n\r\n  var pluginIndex = pluginFirst ? key.indexOf('!') : key.lastIndexOf('!');\r\n\r\n  if (pluginIndex === -1)\r\n    return;\r\n\r\n  if (pluginFirst) {\r\n    argumentKey = key.substr(pluginIndex + 1);\r\n    pluginKey = key.substr(0, pluginIndex);\r\n  }\r\n  else {\r\n    argumentKey = key.substr(0, pluginIndex);\r\n    pluginKey = key.substr(pluginIndex + 1) || argumentKey.substr(argumentKey.lastIndexOf('.') + 1);\r\n  }\r\n\r\n  return {\r\n    argument: argumentKey,\r\n    plugin: pluginKey\r\n  };\r\n}\r\n\r\n// put key back together after parts have been normalized\r\nfunction combinePluginParts (pluginFirst, argumentKey, pluginKey) {\r\n  if (pluginFirst)\r\n    return pluginKey + '!' + argumentKey;\r\n  else\r\n    return argumentKey + '!' + pluginKey;\r\n}\r\n\r\n/*\r\n * Package Configuration Extension\r\n *\r\n * Example:\r\n *\r\n * SystemJS.packages = {\r\n *   jquery: {\r\n *     main: 'index.js', // when not set, package key is requested directly\r\n *     format: 'amd',\r\n *     defaultExtension: 'ts', // defaults to 'js', can be set to false\r\n *     modules: {\r\n *       '*.ts': {\r\n *         loader: 'typescript'\r\n *       },\r\n *       'vendor/sizzle.js': {\r\n *         format: 'global'\r\n *       }\r\n *     },\r\n *     map: {\r\n *        // map internal require('sizzle') to local require('./vendor/sizzle')\r\n *        sizzle: './vendor/sizzle.js',\r\n *        // map any internal or external require of 'jquery/vendor/another' to 'another/index.js'\r\n *        './vendor/another.js': './another/index.js',\r\n *        // test.js / test -> lib/test.js\r\n *        './test.js': './lib/test.js',\r\n *\r\n *        // environment-specific map configurations\r\n *        './index.js': {\r\n *          '~browser': './index-node.js',\r\n *          './custom-condition.js|~export': './index-custom.js'\r\n *        }\r\n *     },\r\n *     // allows for setting package-prefixed depCache\r\n *     // keys are normalized module keys relative to the package itself\r\n *     depCache: {\r\n *       // import 'package/index.js' loads in parallel package/lib/test.js,package/vendor/sizzle.js\r\n *       './index.js': ['./test'],\r\n *       './test.js': ['external-dep'],\r\n *       'external-dep/path.js': ['./another.js']\r\n *     }\r\n *   }\r\n * };\r\n *\r\n * Then:\r\n *   import 'jquery'                       -> jquery/index.js\r\n *   import 'jquery/submodule'             -> jquery/submodule.js\r\n *   import 'jquery/submodule.ts'          -> jquery/submodule.ts loaded as typescript\r\n *   import 'jquery/vendor/another'        -> another/index.js\r\n *\r\n * Detailed Behaviours\r\n * - main can have a leading \"./\" can be added optionally\r\n * - map and defaultExtension are applied to the main\r\n * - defaultExtension adds the extension only if the exact extension is not present\r\n\r\n * - if a meta value is available for a module, map and defaultExtension are skipped\r\n * - like global map, package map also applies to subpaths (sizzle/x, ./vendor/another/sub)\r\n * - condition module map is '@env' module in package or '@system-env' globally\r\n * - map targets support conditional interpolation ('./x': './x.#{|env}.js')\r\n * - internal package map targets cannot use boolean conditionals\r\n *\r\n * Package Configuration Loading\r\n *\r\n * Not all packages may already have their configuration present in the System config\r\n * For these cases, a list of packageConfigPaths can be provided, which when matched against\r\n * a request, will first request a \".json\" file by the package key to derive the package\r\n * configuration from. This allows dynamic loading of non-predetermined code, a key use\r\n * case in SystemJS.\r\n *\r\n * Example:\r\n *\r\n *   SystemJS.packageConfigPaths = ['packages/test/package.json', 'packages/*.json'];\r\n *\r\n *   // will first request 'packages/new-package/package.json' for the package config\r\n *   // before completing the package request to 'packages/new-package/path'\r\n *   SystemJS.import('packages/new-package/path');\r\n *\r\n *   // will first request 'packages/test/package.json' before the main\r\n *   SystemJS.import('packages/test');\r\n *\r\n * When a package matches packageConfigPaths, it will always send a config request for\r\n * the package configuration.\r\n * The package key itself is taken to be the match up to and including the last wildcard\r\n * or trailing slash.\r\n * The most specific package config path will be used.\r\n * Any existing package configurations for the package will deeply merge with the\r\n * package config, with the existing package configurations taking preference.\r\n * To opt-out of the package configuration request for a package that matches\r\n * packageConfigPaths, use the { configured: true } package config option.\r\n *\r\n */\r\n\r\nfunction addDefaultExtension (config, pkg, pkgKey, subPath, skipExtensions) {\r\n  // don't apply extensions to folders or if defaultExtension = false\r\n  if (!subPath || !pkg.defaultExtension || subPath[subPath.length - 1] === '/' || skipExtensions)\r\n    return subPath;\r\n\r\n  var metaMatch = false;\r\n\r\n  // exact meta or meta with any content after the last wildcard skips extension\r\n  if (pkg.meta)\r\n    getMetaMatches(pkg.meta, subPath, function (metaPattern, matchMeta, matchDepth) {\r\n      if (matchDepth === 0 || metaPattern.lastIndexOf('*') !== metaPattern.length - 1)\r\n        return metaMatch = true;\r\n    });\r\n\r\n  // exact global meta or meta with any content after the last wildcard skips extension\r\n  if (!metaMatch && config.meta)\r\n    getMetaMatches(config.meta, pkgKey + '/' + subPath, function (metaPattern, matchMeta, matchDepth) {\r\n      if (matchDepth === 0 || metaPattern.lastIndexOf('*') !== metaPattern.length - 1)\r\n        return metaMatch = true;\r\n    });\r\n\r\n  if (metaMatch)\r\n    return subPath;\r\n\r\n  // work out what the defaultExtension is and add if not there already\r\n  var defaultExtension = '.' + pkg.defaultExtension;\r\n  if (subPath.substr(subPath.length - defaultExtension.length) !== defaultExtension)\r\n    return subPath + defaultExtension;\r\n  else\r\n    return subPath;\r\n}\r\n\r\nfunction applyPackageConfigSync (loader, config, pkg, pkgKey, subPath, metadata, skipExtensions) {\r\n  // main\r\n  if (!subPath) {\r\n    if (pkg.main)\r\n      subPath = pkg.main.substr(0, 2) === './' ? pkg.main.substr(2) : pkg.main;\r\n    else\r\n      // also no submap if key is package itself (import 'pkg' -> 'path/to/pkg.js')\r\n      // NB can add a default package main convention here\r\n      // if it becomes internal to the package then it would no longer be an exit path\r\n      return pkgKey;\r\n  }\r\n\r\n  // map config checking without then with extensions\r\n  if (pkg.map) {\r\n    var mapPath = './' + subPath;\r\n\r\n    var mapMatch = getMapMatch(pkg.map, mapPath);\r\n\r\n    // we then check map with the default extension adding\r\n    if (!mapMatch) {\r\n      mapPath = './' + addDefaultExtension(config, pkg, pkgKey, subPath, skipExtensions);\r\n      if (mapPath !== './' + subPath)\r\n        mapMatch = getMapMatch(pkg.map, mapPath);\r\n    }\r\n    if (mapMatch) {\r\n      var mapped = doMapSync(loader, config, pkg, pkgKey, mapMatch, mapPath, metadata, skipExtensions);\r\n      if (mapped)\r\n        return mapped;\r\n    }\r\n  }\r\n\r\n  // normal package resolution\r\n  return pkgKey + '/' + addDefaultExtension(config, pkg, pkgKey, subPath, skipExtensions);\r\n}\r\n\r\nfunction validMapping (mapMatch, mapped, path) {\r\n  // allow internal ./x -> ./x/y or ./x/ -> ./x/y recursive maps\r\n  // but only if the path is exactly ./x and not ./x/z\r\n  if (mapped.substr(0, mapMatch.length) === mapMatch && path.length > mapMatch.length)\r\n    return false;\r\n\r\n  return true;\r\n}\r\n\r\nfunction doMapSync (loader, config, pkg, pkgKey, mapMatch, path, metadata, skipExtensions) {\r\n  if (path[path.length - 1] === '/')\r\n    path = path.substr(0, path.length - 1);\r\n  var mapped = pkg.map[mapMatch];\r\n\r\n  if (typeof mapped === 'object')\r\n    throw new Error('Synchronous conditional normalization not supported sync normalizing ' + mapMatch + ' in ' + pkgKey);\r\n\r\n  if (!validMapping(mapMatch, mapped, path) || typeof mapped !== 'string')\r\n    return;\r\n\r\n  return packageResolveSync.call(loader, config, mapped + path.substr(mapMatch.length), pkgKey + '/', metadata, metadata, skipExtensions);\r\n}\r\n\r\nfunction applyPackageConfig (loader, config, pkg, pkgKey, subPath, metadata, skipExtensions) {\r\n  // main\r\n  if (!subPath) {\r\n    if (pkg.main)\r\n      subPath = pkg.main.substr(0, 2) === './' ? pkg.main.substr(2) : pkg.main;\r\n    // also no submap if key is package itself (import 'pkg' -> 'path/to/pkg.js')\r\n    else\r\n      // NB can add a default package main convention here\r\n      // if it becomes internal to the package then it would no longer be an exit path\r\n      return Promise.resolve(pkgKey);\r\n  }\r\n\r\n  // map config checking without then with extensions\r\n  var mapPath, mapMatch;\r\n\r\n  if (pkg.map) {\r\n    mapPath = './' + subPath;\r\n    mapMatch = getMapMatch(pkg.map, mapPath);\r\n\r\n    // we then check map with the default extension adding\r\n    if (!mapMatch) {\r\n      mapPath = './' + addDefaultExtension(config, pkg, pkgKey, subPath, skipExtensions);\r\n      if (mapPath !== './' + subPath)\r\n        mapMatch = getMapMatch(pkg.map, mapPath);\r\n    }\r\n  }\r\n\r\n  return (mapMatch ? doMap(loader, config, pkg, pkgKey, mapMatch, mapPath, metadata, skipExtensions) : resolvedPromise)\r\n  .then(function (mapped) {\r\n    if (mapped)\r\n      return Promise.resolve(mapped);\r\n\r\n    // normal package resolution / fallback resolution for no conditional match\r\n    return Promise.resolve(pkgKey + '/' + addDefaultExtension(config, pkg, pkgKey, subPath, skipExtensions));\r\n  });\r\n}\r\n\r\nfunction doMap (loader, config, pkg, pkgKey, mapMatch, path, metadata, skipExtensions) {\r\n  if (path[path.length - 1] === '/')\r\n    path = path.substr(0, path.length - 1);\r\n\r\n  var mapped = pkg.map[mapMatch];\r\n\r\n  if (typeof mapped === 'string') {\r\n    if (!validMapping(mapMatch, mapped, path))\r\n      return resolvedPromise;\r\n    return packageResolve.call(loader, config, mapped + path.substr(mapMatch.length), pkgKey + '/', metadata, metadata, skipExtensions)\r\n    .then(function (normalized) {\r\n      return interpolateConditional.call(loader, normalized, pkgKey + '/', metadata);\r\n    });\r\n  }\r\n\r\n  // we use a special conditional syntax to allow the builder to handle conditional branch points further\r\n  /*if (loader.builder)\r\n    return Promise.resolve(pkgKey + '/#:' + path);*/\r\n\r\n  // we load all conditions upfront\r\n  var conditionPromises = [];\r\n  var conditions = [];\r\n  for (var e in mapped) {\r\n    var c = parseCondition(e);\r\n    conditions.push({\r\n      condition: c,\r\n      map: mapped[e]\r\n    });\r\n    conditionPromises.push(RegisterLoader.prototype.import.call(loader, c.module, pkgKey));\r\n  }\r\n\r\n  // map object -> conditional map\r\n  return Promise.all(conditionPromises)\r\n  .then(function (conditionValues) {\r\n    // first map condition to match is used\r\n    for (var i = 0; i < conditions.length; i++) {\r\n      var c = conditions[i].condition;\r\n      var value = readMemberExpression(c.prop, '__useDefault' in conditionValues[i] ? conditionValues[i].__useDefault : conditionValues[i]);\r\n      if (!c.negate && value || c.negate && !value)\r\n        return conditions[i].map;\r\n    }\r\n  })\r\n  .then(function (mapped) {\r\n    if (mapped) {\r\n      if (!validMapping(mapMatch, mapped, path))\r\n        return resolvedPromise;\r\n      return packageResolve.call(loader, config, mapped + path.substr(mapMatch.length), pkgKey + '/', metadata, metadata, skipExtensions)\r\n      .then(function (normalized) {\r\n        return interpolateConditional.call(loader, normalized, pkgKey + '/', metadata);\r\n      });\r\n    }\r\n\r\n    // no environment match -> fallback to original subPath by returning undefined\r\n  });\r\n}\r\n\r\n// check if the given normalized key matches a packageConfigPath\r\n// if so, loads the config\r\nvar packageConfigPaths = {};\r\n\r\n// data object for quick checks against package paths\r\nfunction createPkgConfigPathObj (path) {\r\n  var lastWildcard = path.lastIndexOf('*');\r\n  var length = Math.max(lastWildcard + 1, path.lastIndexOf('/'));\r\n  return {\r\n    length: length,\r\n    regEx: new RegExp('^(' + path.substr(0, length).replace(/[.+?^${}()|[\\]\\\\]/g, '\\\\$&').replace(/\\*/g, '[^\\\\/]+') + ')(\\\\/|$)'),\r\n    wildcard: lastWildcard !== -1\r\n  };\r\n}\r\n\r\n// most specific match wins\r\nfunction getPackageConfigMatch (config, normalized) {\r\n  var pkgKey, exactMatch = false, configPath;\r\n  for (var i = 0; i < config.packageConfigPaths.length; i++) {\r\n    var packageConfigPath = config.packageConfigPaths[i];\r\n    var p = packageConfigPaths[packageConfigPath] || (packageConfigPaths[packageConfigPath] = createPkgConfigPathObj(packageConfigPath));\r\n    if (normalized.length < p.length)\r\n      continue;\r\n    var match = normalized.match(p.regEx);\r\n    if (match && (!pkgKey || (!(exactMatch && p.wildcard) && pkgKey.length < match[1].length))) {\r\n      pkgKey = match[1];\r\n      exactMatch = !p.wildcard;\r\n      configPath = pkgKey + packageConfigPath.substr(p.length);\r\n    }\r\n  }\r\n\r\n  if (!pkgKey)\r\n    return;\r\n\r\n  return {\r\n    packageKey: pkgKey,\r\n    configPath: configPath\r\n  };\r\n}\r\n\r\nfunction loadPackageConfigPath (loader, config, pkgConfigPath, metadata, normalized) {\r\n  var configLoader = loader.pluginLoader || loader;\r\n\r\n  // ensure we note this is a package config file path\r\n  // it will then be skipped from getting other normalizations itself to ensure idempotency\r\n  if (config.packageConfigKeys.indexOf(pkgConfigPath) === -1)\r\n    config.packageConfigKeys.push(pkgConfigPath);\r\n\r\n  return configLoader.import(pkgConfigPath)\r\n  .then(function (pkgConfig) {\r\n    setPkgConfig(metadata.packageConfig, pkgConfig, metadata.packageKey, true, config);\r\n    metadata.packageConfig.configured = true;\r\n  })\r\n  .catch(function (err) {\r\n    throw addToError(err, 'Unable to fetch package configuration file ' + pkgConfigPath);\r\n  });\r\n}\r\n\r\nfunction getMetaMatches (pkgMeta, subPath, matchFn) {\r\n  // wildcard meta\r\n  var wildcardIndex;\r\n  for (var module in pkgMeta) {\r\n    // allow meta to start with ./ for flexibility\r\n    var dotRel = module.substr(0, 2) === './' ? './' : '';\r\n    if (dotRel)\r\n      module = module.substr(2);\r\n\r\n    wildcardIndex = module.indexOf('*');\r\n    if (wildcardIndex === -1)\r\n      continue;\r\n\r\n    if (module.substr(0, wildcardIndex) === subPath.substr(0, wildcardIndex)\r\n        && module.substr(wildcardIndex + 1) === subPath.substr(subPath.length - module.length + wildcardIndex + 1)) {\r\n      // alow match function to return true for an exit path\r\n      if (matchFn(module, pkgMeta[dotRel + module], module.split('/').length))\r\n        return;\r\n    }\r\n  }\r\n  // exact meta\r\n  var exactMeta = pkgMeta[subPath] && Object.hasOwnProperty.call(pkgMeta, subPath) ? pkgMeta[subPath] : pkgMeta['./' + subPath];\r\n  if (exactMeta)\r\n    matchFn(exactMeta, exactMeta, 0);\r\n}\r\n\r\n\r\n/*\r\n * Conditions Extension\r\n *\r\n *   Allows a condition module to alter the resolution of an import via syntax:\r\n *\r\n *     import $ from 'jquery/#{browser}';\r\n *\r\n *   Will first load the module 'browser' via `SystemJS.import('browser')` and\r\n *   take the default export of that module.\r\n *   If the default export is not a string, an error is thrown.\r\n *\r\n *   We then substitute the string into the require to get the conditional resolution\r\n *   enabling environment-specific variations like:\r\n *\r\n *     import $ from 'jquery/ie'\r\n *     import $ from 'jquery/firefox'\r\n *     import $ from 'jquery/chrome'\r\n *     import $ from 'jquery/safari'\r\n *\r\n *   It can be useful for a condition module to define multiple conditions.\r\n *   This can be done via the `|` modifier to specify an export member expression:\r\n *\r\n *     import 'jquery/#{./browser.js|grade.version}'\r\n *\r\n *   Where the `grade` export `version` member in the `browser.js` module  is substituted.\r\n *\r\n *\r\n * Boolean Conditionals\r\n *\r\n *   For polyfill modules, that are used as imports but have no module value,\r\n *   a binary conditional allows a module not to be loaded at all if not needed:\r\n *\r\n *     import 'es5-shim#?./conditions.js|needs-es5shim'\r\n *\r\n *   These conditions can also be negated via:\r\n *\r\n *     import 'es5-shim#?./conditions.js|~es6'\r\n *\r\n */\r\n\r\nvar sysConditions = ['browser', 'node', 'dev', 'build', 'production', 'default'];\r\n\r\nfunction parseCondition (condition) {\r\n  var conditionExport, conditionModule, negation;\r\n\r\n  var negation;\r\n  var conditionExportIndex = condition.lastIndexOf('|');\r\n  if (conditionExportIndex !== -1) {\r\n    conditionExport = condition.substr(conditionExportIndex + 1);\r\n    conditionModule = condition.substr(0, conditionExportIndex);\r\n\r\n    if (conditionExport[0] === '~') {\r\n      negation = true;\r\n      conditionExport = conditionExport.substr(1);\r\n    }\r\n  }\r\n  else {\r\n    negation = condition[0] === '~';\r\n    conditionExport = 'default';\r\n    conditionModule = condition.substr(negation);\r\n    if (sysConditions.indexOf(conditionModule) !== -1) {\r\n      conditionExport = conditionModule;\r\n      conditionModule = null;\r\n    }\r\n  }\r\n\r\n  return {\r\n    module: conditionModule || '@system-env',\r\n    prop: conditionExport,\r\n    negate: negation\r\n  };\r\n}\r\n\r\nfunction resolveCondition (conditionObj, parentKey, bool) {\r\n  // import without __useDefault handling here\r\n  return RegisterLoader.prototype.import.call(this, conditionObj.module, parentKey)\r\n  .then(function (condition) {\r\n    var m = readMemberExpression(conditionObj.prop, condition);\r\n\r\n    if (bool && typeof m !== 'boolean')\r\n      throw new TypeError('Condition did not resolve to a boolean.');\r\n\r\n    return conditionObj.negate ? !m : m;\r\n  });\r\n}\r\n\r\nvar interpolationRegEx = /#\\{[^\\}]+\\}/;\r\nfunction interpolateConditional (key, parentKey, parentMetadata) {\r\n  // first we normalize the conditional\r\n  var conditionalMatch = key.match(interpolationRegEx);\r\n\r\n  if (!conditionalMatch)\r\n    return Promise.resolve(key);\r\n\r\n  var conditionObj = parseCondition.call(this, conditionalMatch[0].substr(2, conditionalMatch[0].length - 3));\r\n\r\n  // in builds, return normalized conditional\r\n  /*if (this.builder)\r\n    return this.normalize(conditionObj.module, parentKey, createMetadata(), parentMetadata)\r\n    .then(function (conditionModule) {\r\n      conditionObj.module = conditionModule;\r\n      return key.replace(interpolationRegEx, '#{' + serializeCondition(conditionObj) + '}');\r\n    });*/\r\n\r\n  return resolveCondition.call(this, conditionObj, parentKey, false)\r\n  .then(function (conditionValue) {\r\n    if (typeof conditionValue !== 'string')\r\n      throw new TypeError('The condition value for ' + key + ' doesn\\'t resolve to a string.');\r\n\r\n    if (conditionValue.indexOf('/') !== -1)\r\n      throw new TypeError('Unabled to interpolate conditional ' + key + (parentKey ? ' in ' + parentKey : '') + '\\n\\tThe condition value ' + conditionValue + ' cannot contain a \"/\" separator.');\r\n\r\n    return key.replace(interpolationRegEx, conditionValue);\r\n  });\r\n}\r\n","import { envModule, setProduction, configNames } from './systemjs-loader.js';\r\nimport { extend, prepend, warn, resolveIfNotPlain, baseURI, CONFIG } from './common.js';\r\nimport { coreResolve } from './resolve.js';\r\n\r\n/*\r\n Extend config merging one deep only\r\n\r\n  loader.config({\r\n    some: 'random',\r\n    config: 'here',\r\n    deep: {\r\n      config: { too: 'too' }\r\n    }\r\n  });\r\n\r\n  <=>\r\n\r\n  loader.some = 'random';\r\n  loader.config = 'here'\r\n  loader.deep = loader.deep || {};\r\n  loader.deep.config = { too: 'too' };\r\n\r\n\r\n  Normalizes meta and package configs allowing for:\r\n\r\n  SystemJS.config({\r\n    meta: {\r\n      './index.js': {}\r\n    }\r\n  });\r\n\r\n  To become\r\n\r\n  SystemJS.meta['https://thissite.com/index.js'] = {};\r\n\r\n  For easy normalization canonicalization with latest URL support.\r\n\r\n*/\r\nvar envConfigNames = ['browserConfig', 'nodeConfig', 'devConfig', 'buildConfig', 'productionConfig'];\r\nfunction envSet(loader, cfg, envCallback) {\r\n  for (var i = 0; i < envConfigNames.length; i++) {\r\n    var envConfig = envConfigNames[i];\r\n    if (cfg[envConfig] && envModule[envConfig.substr(0, envConfig.length - 6)])\r\n      envCallback(cfg[envConfig]);\r\n  }\r\n}\r\n\r\nfunction cloneObj (obj, maxDepth) {\r\n  var clone = {};\r\n  for (var p in obj) {\r\n    var prop = obj[p];\r\n    if (maxDepth > 1) {\r\n      if (prop instanceof Array)\r\n        clone[p] = [].concat(prop);\r\n      else if (typeof prop === 'object')\r\n        clone[p] = cloneObj(prop, maxDepth - 1);\r\n      else if (p !== 'packageConfig')\r\n        clone[p] = prop;\r\n    }\r\n    else {\r\n      clone[p] = prop;\r\n    }\r\n  }\r\n  return clone;\r\n}\r\n\r\nexport function getConfigItem (config, p) {\r\n  var cfgItem = config[p];\r\n\r\n  // getConfig must return an unmodifiable clone of the configuration\r\n  if (cfgItem instanceof Array)\r\n    return config[p].concat([]);\r\n  else if (typeof cfgItem === 'object')\r\n    return cloneObj(cfgItem, 3)\r\n  else\r\n    return config[p];\r\n}\r\n\r\nexport function getConfig (configName) {\r\n  if (configName) {\r\n    if (configNames.indexOf(configName) !== -1)\r\n      return getConfigItem(this[CONFIG], configName);\r\n    throw new Error('\"' + configName + '\" is not a valid configuration name. Must be one of ' + configNames.join(', ') + '.');\r\n  }\r\n\r\n  var cfg = {};\r\n  for (var i = 0; i < configNames.length; i++) {\r\n    var p = configNames[i];\r\n    var configItem = getConfigItem(this[CONFIG], p);\r\n    if (configItem !== undefined)\r\n      cfg[p] = configItem;\r\n  }\r\n  return cfg;\r\n}\r\n\r\nexport function setConfig (cfg, isEnvConfig) {\r\n  var loader = this;\r\n  var config = this[CONFIG];\r\n\r\n  if ('warnings' in cfg)\r\n    config.warnings = cfg.warnings;\r\n\r\n  if ('wasm' in cfg)\r\n    config.wasm = typeof WebAssembly !== 'undefined' && cfg.wasm;\r\n\r\n  if ('production' in cfg || 'build' in cfg)\r\n    setProduction.call(loader, !!cfg.production, !!(cfg.build || envModule && envModule.build));\r\n\r\n  if (!isEnvConfig) {\r\n    // if using nodeConfig / browserConfig / productionConfig, take baseURL from there\r\n    // these exceptions will be unnecessary when we can properly implement config queuings\r\n    var baseURL;\r\n    envSet(loader, cfg, function(cfg) {\r\n      baseURL = baseURL || cfg.baseURL;\r\n    });\r\n    baseURL = baseURL || cfg.baseURL;\r\n\r\n    // always configure baseURL first\r\n    if (baseURL) {\r\n      config.baseURL = resolveIfNotPlain(baseURL, baseURI) || resolveIfNotPlain('./' + baseURL, baseURI);\r\n      if (config.baseURL[config.baseURL.length - 1] !== '/')\r\n        config.baseURL += '/';\r\n    }\r\n\r\n    if (cfg.paths)\r\n      extend(config.paths, cfg.paths);\r\n\r\n    envSet(loader, cfg, function(cfg) {\r\n      if (cfg.paths)\r\n        extend(config.paths, cfg.paths);\r\n    });\r\n\r\n    for (var p in config.paths) {\r\n      if (config.paths[p].indexOf('*') === -1)\r\n        continue;\r\n      warn.call(config, 'Path config ' + p + ' -> ' + config.paths[p] + ' is no longer supported as wildcards are deprecated.');\r\n      delete config.paths[p];\r\n    }\r\n  }\r\n\r\n  if (cfg.defaultJSExtensions)\r\n    warn.call(config, 'The defaultJSExtensions configuration option is deprecated.\\n  Use packages defaultExtension instead.', true);\r\n\r\n  if (typeof cfg.pluginFirst === 'boolean')\r\n    config.pluginFirst = cfg.pluginFirst;\r\n\r\n  if (cfg.map) {\r\n    for (var p in cfg.map) {\r\n      var v = cfg.map[p];\r\n\r\n      if (typeof v === 'string') {\r\n        var mapped = coreResolve.call(loader, config, v, undefined, false, false);\r\n        if (mapped[mapped.length -1] === '/' && p[p.length - 1] !== ':' && p[p.length - 1] !== '/')\r\n          mapped = mapped.substr(0, mapped.length - 1);\r\n        config.map[p] = mapped;\r\n      }\r\n\r\n      // object map\r\n      else {\r\n        var pkgName = coreResolve.call(loader, config, p[p.length - 1] !== '/' ? p + '/' : p, undefined, true, true);\r\n        pkgName = pkgName.substr(0, pkgName.length - 1);\r\n\r\n        var pkg = config.packages[pkgName];\r\n        if (!pkg) {\r\n          pkg = config.packages[pkgName] = createPackage();\r\n          // use '' instead of false to keep type consistent\r\n          pkg.defaultExtension = '';\r\n        }\r\n        setPkgConfig(pkg, { map: v }, pkgName, false, config);\r\n      }\r\n    }\r\n  }\r\n\r\n  if (cfg.packageConfigPaths) {\r\n    var packageConfigPaths = [];\r\n    for (var i = 0; i < cfg.packageConfigPaths.length; i++) {\r\n      var path = cfg.packageConfigPaths[i];\r\n      var packageLength = Math.max(path.lastIndexOf('*') + 1, path.lastIndexOf('/'));\r\n      var normalized = coreResolve.call(loader, config, path.substr(0, packageLength), undefined, false, false);\r\n      packageConfigPaths[i] = normalized + path.substr(packageLength);\r\n    }\r\n    config.packageConfigPaths = packageConfigPaths;\r\n  }\r\n\r\n  if (cfg.bundles) {\r\n    for (var p in cfg.bundles) {\r\n      var bundle = [];\r\n      for (var i = 0; i < cfg.bundles[p].length; i++)\r\n        bundle.push(loader.normalizeSync(cfg.bundles[p][i]));\r\n      config.bundles[p] = bundle;\r\n    }\r\n  }\r\n\r\n  if (cfg.packages) {\r\n    for (var p in cfg.packages) {\r\n      if (p.match(/^([^\\/]+:)?\\/\\/$/))\r\n        throw new TypeError('\"' + p + '\" is not a valid package name.');\r\n\r\n      var pkgName = coreResolve.call(loader, config, p[p.length - 1] !== '/' ? p + '/' : p, undefined, true, true);\r\n      pkgName = pkgName.substr(0, pkgName.length - 1);\r\n\r\n      setPkgConfig(config.packages[pkgName] = config.packages[pkgName] || createPackage(), cfg.packages[p], pkgName, false, config);\r\n    }\r\n  }\r\n\r\n  if (cfg.depCache) {\r\n    for (var p in cfg.depCache)\r\n      config.depCache[loader.normalizeSync(p)] = [].concat(cfg.depCache[p]);\r\n  }\r\n\r\n  if (cfg.meta) {\r\n    for (var p in cfg.meta) {\r\n      // base wildcard stays base\r\n      if (p[0] === '*') {\r\n        extend(config.meta[p] = config.meta[p] || {}, cfg.meta[p]);\r\n      }\r\n      else {\r\n        var resolved = coreResolve.call(loader, config, p, undefined, true, true);\r\n        extend(config.meta[resolved] = config.meta[resolved] || {}, cfg.meta[p]);\r\n      }\r\n    }\r\n  }\r\n\r\n  if ('transpiler' in cfg)\r\n    config.transpiler = cfg.transpiler;\r\n\r\n\r\n  // copy any remaining non-standard configuration properties\r\n  for (var c in cfg) {\r\n    if (configNames.indexOf(c) !== -1)\r\n      continue;\r\n    if (envConfigNames.indexOf(c) !== -1)\r\n      continue;\r\n\r\n    // warn.call(config, 'Setting custom config option `System.config({ ' + c + ': ... })` is deprecated. Avoid custom config options or set SystemJS.' + c + ' = ... directly.');\r\n    loader[c] = cfg[c];\r\n  }\r\n\r\n  envSet(loader, cfg, function(cfg) {\r\n    loader.config(cfg, true);\r\n  });\r\n}\r\n\r\nexport function createPackage () {\r\n  return {\r\n    defaultExtension: undefined,\r\n    main: undefined,\r\n    format: undefined,\r\n    meta: undefined,\r\n    map: undefined,\r\n    packageConfig: undefined,\r\n    configured: false\r\n  };\r\n}\r\n\r\n// deeply-merge (to first level) config with any existing package config\r\nexport function setPkgConfig (pkg, cfg, pkgName, prependConfig, config) {\r\n  for (var prop in cfg) {\r\n    if (prop === 'main' || prop === 'format' || prop === 'defaultExtension' || prop === 'configured') {\r\n      if (!prependConfig || pkg[prop] === undefined)\r\n        pkg[prop] = cfg[prop];\r\n    }\r\n    else if (prop === 'map') {\r\n      (prependConfig ? prepend : extend)(pkg.map = pkg.map || {}, cfg.map);\r\n    }\r\n    else if (prop === 'meta') {\r\n      (prependConfig ? prepend : extend)(pkg.meta = pkg.meta || {}, cfg.meta);\r\n    }\r\n    else if (Object.hasOwnProperty.call(cfg, prop)) {\r\n      warn.call(config, '\"' + prop + '\" is not a valid package configuration option in package ' + pkgName);\r\n    }\r\n  }\r\n\r\n  // default defaultExtension for packages only\r\n  if (pkg.defaultExtension === undefined)\r\n    pkg.defaultExtension = 'js';\r\n\r\n  if (pkg.main === undefined && pkg.map && pkg.map['.']) {\r\n    pkg.main = pkg.map['.'];\r\n    delete pkg.map['.'];\r\n  }\r\n  // main object becomes main map\r\n  else if (typeof pkg.main === 'object') {\r\n    pkg.map = pkg.map || {};\r\n    pkg.map['./@main'] = pkg.main;\r\n    pkg.main['default'] = pkg.main['default'] || './';\r\n    pkg.main = '@main';\r\n  }\r\n\r\n  return pkg;\r\n}\r\n","import { isBrowser, global } from './common.js';\r\n\r\nvar hasBuffer = typeof Buffer !== 'undefined';\r\ntry {\r\n  if (hasBuffer && new Buffer('a').toString('base64') !== 'YQ==')\r\n    hasBuffer = false;\r\n}\r\ncatch (e) {\r\n  hasBuffer = false;\r\n}\r\n\r\nvar sourceMapPrefix = '\\n//# sourceMapping' + 'URL=data:application/json;base64,';\r\nfunction inlineSourceMap (sourceMapString) {\r\n  if (hasBuffer)\r\n    return sourceMapPrefix + new Buffer(sourceMapString).toString('base64');\r\n  else if (typeof btoa !== 'undefined')\r\n    return sourceMapPrefix + btoa(unescape(encodeURIComponent(sourceMapString)));\r\n  else\r\n    return '';\r\n}\r\n\r\nfunction getSource(source, sourceMap, address, wrap) {\r\n  var lastLineIndex = source.lastIndexOf('\\n');\r\n\r\n  if (sourceMap) {\r\n    if (typeof sourceMap != 'object')\r\n      throw new TypeError('load.metadata.sourceMap must be set to an object.');\r\n\r\n    sourceMap = JSON.stringify(sourceMap);\r\n  }\r\n\r\n  return (wrap ? '(function(System, SystemJS) {' : '') + source + (wrap ? '\\n})(System, System);' : '')\r\n      // adds the sourceURL comment if not already present\r\n      + (source.substr(lastLineIndex, 15) != '\\n//# sourceURL='\r\n        ? '\\n//# sourceURL=' + address + (sourceMap ? '!transpiled' : '') : '')\r\n      // add sourceMappingURL if load.metadata.sourceMap is set\r\n      + (sourceMap && inlineSourceMap(sourceMap) || '');\r\n}\r\n\r\n// script execution via injecting a script tag into the page\r\n// this allows CSP nonce to be set for CSP environments\r\nvar head;\r\nfunction scriptExec(loader, source, sourceMap, address, nonce) {\r\n  if (!head)\r\n    head = document.head || document.body || document.documentElement;\r\n\r\n  var script = document.createElement('script');\r\n  script.text = getSource(source, sourceMap, address, false);\r\n  var onerror = window.onerror;\r\n  var e;\r\n  window.onerror = function(_e) {\r\n    e = addToError(_e, 'Evaluating ' + address);\r\n    if (onerror)\r\n      onerror.apply(this, arguments);\r\n  }\r\n  preExec(loader);\r\n\r\n  if (nonce)\r\n    script.setAttribute('nonce', nonce);\r\n\r\n  head.appendChild(script);\r\n  head.removeChild(script);\r\n  postExec();\r\n  window.onerror = onerror;\r\n  if (e)\r\n    return e;\r\n}\r\n\r\nvar vm;\r\nvar useVm;\r\n\r\nvar curSystem;\r\n\r\nvar callCounter = 0;\r\nfunction preExec (loader) {\r\n  if (callCounter++ == 0)\r\n    curSystem = global.System;\r\n  global.System = global.SystemJS = loader;\r\n}\r\nfunction postExec () {\r\n  if (--callCounter == 0)\r\n    global.System = global.SystemJS = curSystem;\r\n}\r\n\r\nvar supportsScriptExec = false;\r\nif (isBrowser && typeof document != 'undefined' && document.getElementsByTagName) {\r\n  if (!(window.chrome && window.chrome.extension || navigator.userAgent.match(/^Node\\.js/)))\r\n    supportsScriptExec = true;\r\n}\r\n\r\nexport function evaluate (loader, source, sourceMap, address, integrity, nonce, noWrap) {\r\n  if (!source)\r\n    return;\r\n  if (nonce && supportsScriptExec)\r\n    return scriptExec(loader, source, sourceMap, address, nonce);\r\n  try {\r\n    preExec(loader);\r\n    // global scoped eval for node (avoids require scope leak)\r\n    if (!vm && loader._nodeRequire) {\r\n      vm = loader._nodeRequire('vm');\r\n      useVm = vm.runInThisContext(\"typeof System !== 'undefined' && System\") === loader;\r\n    }\r\n    if (useVm)\r\n      vm.runInThisContext(getSource(source, sourceMap, address, !noWrap), { filename: address + (sourceMap ? '!transpiled' : '') });\r\n    else\r\n      (0, eval)(getSource(source, sourceMap, address, !noWrap));\r\n    postExec();\r\n  }\r\n  catch (e) {\r\n    postExec();\r\n    return e;\r\n  }\r\n}\r\n","\r\nimport { isWindows, global, readMemberExpression, cjsRequireRegEx, noop } from './common.js';\r\n\r\nexport function setHelpers (loader) {\r\n  loader.set('@@cjs-helpers', loader.newModule({\r\n    requireResolve: requireResolve.bind(loader),\r\n    getPathVars: getPathVars\r\n  }));\r\n\r\n  loader.set('@@global-helpers', loader.newModule({\r\n    prepareGlobal: prepareGlobal\r\n  }));\r\n}\r\n\r\nexport function setAmdHelper (loader) {\r\n\r\n  /*\r\n    AMD-compatible require\r\n    To copy RequireJS, set window.require = window.requirejs = loader.amdRequire\r\n  */\r\n  function require (names, callback, errback, referer) {\r\n    // in amd, first arg can be a config object... we just ignore\r\n    if (typeof names === 'object' && !(names instanceof Array))\r\n      return require.apply(null, Array.prototype.splice.call(arguments, 1, arguments.length - 1));\r\n\r\n    // amd require\r\n    if (typeof names === 'string' && typeof callback === 'function')\r\n      names = [names];\r\n    if (names instanceof Array) {\r\n      var dynamicRequires = [];\r\n      for (var i = 0; i < names.length; i++)\r\n        dynamicRequires.push(loader.import(names[i], referer));\r\n      Promise.all(dynamicRequires).then(function (modules) {\r\n        if (callback)\r\n          callback.apply(null, modules);\r\n      }, errback);\r\n    }\r\n\r\n    // commonjs require\r\n    else if (typeof names === 'string') {\r\n      var normalized = loader.decanonicalize(names, referer);\r\n      var module = loader.get(normalized);\r\n      if (!module)\r\n        throw new Error('Module not already loaded loading \"' + names + '\" as ' + normalized + (referer ? ' from \"' + referer + '\".' : '.'));\r\n      return '__useDefault' in module ? module.__useDefault : module;\r\n    }\r\n\r\n    else\r\n      throw new TypeError('Invalid require');\r\n  }\r\n\r\n  function define (name, deps, factory) {\r\n    if (typeof name !== 'string') {\r\n      factory = deps;\r\n      deps = name;\r\n      name = null;\r\n    }\r\n\r\n    if (!(deps instanceof Array)) {\r\n      factory = deps;\r\n      deps = ['require', 'exports', 'module'].splice(0, factory.length);\r\n    }\r\n\r\n    if (typeof factory !== 'function')\r\n      factory = (function (factory) {\r\n        return function() { return factory; }\r\n      })(factory);\r\n\r\n    if (!name) {\r\n      if (curMetaDeps) {\r\n        deps = deps.concat(curMetaDeps);\r\n        curMetaDeps = undefined;\r\n      }\r\n    }\r\n\r\n    // remove system dependencies\r\n    var requireIndex, exportsIndex, moduleIndex;\r\n\r\n    if ((requireIndex = deps.indexOf('require')) !== -1) {\r\n\r\n      deps.splice(requireIndex, 1);\r\n\r\n      // only trace cjs requires for non-named\r\n      // named defines assume the trace has already been done\r\n      if (!name)\r\n        deps = deps.concat(amdGetCJSDeps(factory.toString(), requireIndex));\r\n    }\r\n\r\n    if ((exportsIndex = deps.indexOf('exports')) !== -1)\r\n      deps.splice(exportsIndex, 1);\r\n\r\n    if ((moduleIndex = deps.indexOf('module')) !== -1)\r\n      deps.splice(moduleIndex, 1);\r\n\r\n    function execute (req, exports, module) {\r\n      var depValues = [];\r\n      for (var i = 0; i < deps.length; i++)\r\n        depValues.push(req(deps[i]));\r\n\r\n      module.uri = module.id;\r\n\r\n      module.config = noop;\r\n\r\n      // add back in system dependencies\r\n      if (moduleIndex !== -1)\r\n        depValues.splice(moduleIndex, 0, module);\r\n\r\n      if (exportsIndex !== -1)\r\n        depValues.splice(exportsIndex, 0, exports);\r\n\r\n      if (requireIndex !== -1) {\r\n        var contextualRequire = function (names, callback, errback) {\r\n          if (typeof names === 'string' && typeof callback !== 'function')\r\n            return req(names);\r\n          return require.call(loader, names, callback, errback, module.id);\r\n        };\r\n        contextualRequire.toUrl = function (name) {\r\n          return loader.normalizeSync(name, module.id);\r\n        };\r\n        depValues.splice(requireIndex, 0, contextualRequire);\r\n      }\r\n\r\n      // set global require to AMD require\r\n      var curRequire = global.require;\r\n      global.require = require;\r\n\r\n      var output = factory.apply(exportsIndex === -1 ? global : exports, depValues);\r\n\r\n      global.require = curRequire;\r\n\r\n      if (typeof output !== 'undefined')\r\n        module.exports = output;\r\n    }\r\n\r\n    // anonymous define\r\n    if (!name) {\r\n      loader.registerDynamic(deps, false, curEsModule ? wrapEsModuleExecute(execute) : execute);\r\n    }\r\n    else {\r\n      loader.registerDynamic(name, deps, false, execute);\r\n\r\n      // if we don't have any other defines,\r\n      // then let this be an anonymous define\r\n      // this is just to support single modules of the form:\r\n      // define('jquery')\r\n      // still loading anonymously\r\n      // because it is done widely enough to be useful\r\n      // as soon as there is more than one define, this gets removed though\r\n      if (lastNamedDefine) {\r\n        lastNamedDefine = undefined;\r\n        multipleNamedDefines = true;\r\n      }\r\n      else if (!multipleNamedDefines) {\r\n        lastNamedDefine = [deps, execute];\r\n      }\r\n    }\r\n  }\r\n  define.amd = {};\r\n\r\n  loader.amdDefine = define;\r\n  loader.amdRequire = require;\r\n}\r\n\r\n// CJS\r\nvar windowOrigin;\r\nif (typeof window !== 'undefined' && typeof document !== 'undefined' && window.location)\r\n  windowOrigin = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '');\r\n\r\nfunction stripOrigin(path) {\r\n  if (path.substr(0, 8) === 'file:///')\r\n    return path.substr(7 + !!isWindows);\r\n\r\n  if (windowOrigin && path.substr(0, windowOrigin.length) === windowOrigin)\r\n    return path.substr(windowOrigin.length);\r\n\r\n  return path;\r\n}\r\n\r\nexport function requireResolve (request, parentId) {\r\n  return stripOrigin(this.normalizeSync(request, parentId));\r\n}\r\n\r\nexport function getPathVars (moduleId) {\r\n  // remove any plugin syntax\r\n  var pluginIndex = moduleId.lastIndexOf('!');\r\n  var filename;\r\n  if (pluginIndex !== -1)\r\n    filename = moduleId.substr(0, pluginIndex);\r\n  else\r\n    filename = moduleId;\r\n\r\n  var dirname = filename.split('/');\r\n  dirname.pop();\r\n  dirname = dirname.join('/');\r\n\r\n  return {\r\n    filename: stripOrigin(filename),\r\n    dirname: stripOrigin(dirname)\r\n  };\r\n}\r\n\r\nvar commentRegEx = /(^|[^\\\\])(\\/\\*([\\s\\S]*?)\\*\\/|([^:]|^)\\/\\/(.*)$)/mg;\r\nvar stringRegEx = /(\"[^\"\\\\\\n\\r]*(\\\\.[^\"\\\\\\n\\r]*)*\"|'[^'\\\\\\n\\r]*(\\\\.[^'\\\\\\n\\r]*)*')/g;\r\n\r\n// used to support leading #!/usr/bin/env in scripts as supported in Node\r\nvar hashBangRegEx = /^\\#\\!.*/;\r\n\r\n// extract CJS dependencies from source text via regex static analysis\r\n// read require('x') statements not in comments or strings\r\nexport function getCJSDeps (source) {\r\n  cjsRequireRegEx.lastIndex = commentRegEx.lastIndex = stringRegEx.lastIndex = 0;\r\n\r\n  var deps = [];\r\n\r\n  var match;\r\n\r\n  // track string and comment locations for unminified source\r\n  var stringLocations = [], commentLocations = [];\r\n\r\n  function inLocation (locations, match) {\r\n    for (var i = 0; i < locations.length; i++)\r\n      if (locations[i][0] < match.index && locations[i][1] > match.index)\r\n        return true;\r\n    return false;\r\n  }\r\n\r\n  if (source.length / source.split('\\n').length < 200) {\r\n    while (match = stringRegEx.exec(source))\r\n      stringLocations.push([match.index, match.index + match[0].length]);\r\n\r\n    // TODO: track template literals here before comments\r\n\r\n    while (match = commentRegEx.exec(source)) {\r\n      // only track comments not starting in strings\r\n      if (!inLocation(stringLocations, match))\r\n        commentLocations.push([match.index + match[1].length, match.index + match[0].length - 1]);\r\n    }\r\n  }\r\n\r\n  while (match = cjsRequireRegEx.exec(source)) {\r\n    // ensure we're not within a string or comment location\r\n    if (!inLocation(stringLocations, match) && !inLocation(commentLocations, match)) {\r\n      var dep = match[1].substr(1, match[1].length - 2);\r\n      // skip cases like require('\" + file + \"')\r\n      if (dep.match(/\"|'/))\r\n        continue;\r\n      deps.push(dep);\r\n    }\r\n  }\r\n\r\n  return deps;\r\n}\r\n\r\n// Global\r\n// bare minimum ignores\r\nvar ignoredGlobalProps = ['_g', 'sessionStorage', 'localStorage', 'clipboardData', 'frames', 'frameElement', 'external',\r\n  'mozAnimationStartTime', 'mozPaintCount', 'webkitStorageInfo', 'webkitIndexedDB', 'mozInnerScreenY', 'mozInnerScreenX'];\r\n\r\nvar globalSnapshot;\r\nexport function globalIterator (globalName) {\r\n  if (ignoredGlobalProps.indexOf(globalName) !== -1)\r\n    return;\r\n  try {\r\n    var value = global[globalName];\r\n  }\r\n  catch (e) {\r\n    ignoredGlobalProps.push(globalName);\r\n  }\r\n  this(globalName, value);\r\n}\r\n\r\nexport function getGlobalValue (exports) {\r\n  if (typeof exports === 'string')\r\n    return readMemberExpression(exports, global);\r\n\r\n  if (!(exports instanceof Array))\r\n    throw new Error('Global exports must be a string or array.');\r\n\r\n  var globalValue = {};\r\n  for (var i = 0; i < exports.length; i++)\r\n    globalValue[exports[i].split('.').pop()] = readMemberExpression(exports[i], global);\r\n  return globalValue;\r\n}\r\n\r\nexport function prepareGlobal (moduleName, exports, globals, encapsulate) {\r\n  // disable module detection\r\n  var curDefine = global.define;\r\n\r\n  global.define = undefined;\r\n\r\n  // set globals\r\n  var oldGlobals;\r\n  if (globals) {\r\n    oldGlobals = {};\r\n    for (var g in globals) {\r\n      oldGlobals[g] = global[g];\r\n      global[g] = globals[g];\r\n    }\r\n  }\r\n\r\n  // store a complete copy of the global object in order to detect changes\r\n  if (!exports) {\r\n    globalSnapshot = {};\r\n\r\n    Object.keys(global).forEach(globalIterator, function (name, value) {\r\n      globalSnapshot[name] = value;\r\n    });\r\n  }\r\n\r\n  // return function to retrieve global\r\n  return function () {\r\n    var globalValue = exports ? getGlobalValue(exports) : {};\r\n\r\n    var singleGlobal;\r\n    var multipleExports = !!exports;\r\n\r\n    if (!exports || encapsulate)\r\n      Object.keys(global).forEach(globalIterator, function (name, value) {\r\n        if (globalSnapshot[name] === value)\r\n          return;\r\n        if (value === undefined)\r\n          return;\r\n\r\n        // allow global encapsulation where globals are removed\r\n        if (encapsulate)\r\n          global[name] = undefined;\r\n\r\n        if (!exports) {\r\n          globalValue[name] = value;\r\n\r\n          if (singleGlobal !== undefined) {\r\n            if (!multipleExports && singleGlobal !== value)\r\n              multipleExports = true;\r\n          }\r\n          else {\r\n            singleGlobal = value;\r\n          }\r\n        }\r\n      });\r\n\r\n    globalValue = multipleExports ? globalValue : singleGlobal;\r\n\r\n    // revert globals\r\n    if (oldGlobals) {\r\n      for (var g in oldGlobals)\r\n        global[g] = oldGlobals[g];\r\n    }\r\n    global.define = curDefine;\r\n\r\n    return globalValue;\r\n  };\r\n}\r\n\r\n// AMD\r\nvar cjsRequirePre = \"(?:^|[^$_a-zA-Z\\\\xA0-\\\\uFFFF.])\";\r\nvar cjsRequirePost = \"\\\\s*\\\\(\\\\s*(\\\"([^\\\"]+)\\\"|'([^']+)')\\\\s*\\\\)\";\r\nvar fnBracketRegEx = /\\(([^\\)]*)\\)/;\r\nvar wsRegEx = /^\\s+|\\s+$/g;\r\n\r\nvar requireRegExs = {};\r\n\r\nfunction amdGetCJSDeps(source, requireIndex) {\r\n\r\n  // remove comments\r\n  source = source.replace(commentRegEx, '');\r\n\r\n  // determine the require alias\r\n  var params = source.match(fnBracketRegEx);\r\n  var requireAlias = (params[1].split(',')[requireIndex] || 'require').replace(wsRegEx, '');\r\n\r\n  // find or generate the regex for this requireAlias\r\n  var requireRegEx = requireRegExs[requireAlias] || (requireRegExs[requireAlias] = new RegExp(cjsRequirePre + requireAlias + cjsRequirePost, 'g'));\r\n\r\n  requireRegEx.lastIndex = 0;\r\n\r\n  var deps = [];\r\n\r\n  var match;\r\n  while (match = requireRegEx.exec(source))\r\n    deps.push(match[2] || match[3]);\r\n\r\n  return deps;\r\n}\r\n\r\nfunction wrapEsModuleExecute (execute) {\r\n  return function (require, exports, module) {\r\n    execute(require, exports, module);\r\n    exports = module.exports;\r\n    if ((typeof exports === 'object' || typeof exports === 'function') && !('__esModule' in exports))\r\n      Object.defineProperty(module.exports, '__esModule', {\r\n        value: true\r\n      });\r\n  };\r\n}\r\n\r\n// generate anonymous define from singular named define\r\nvar multipleNamedDefines = false;\r\nvar lastNamedDefine;\r\nvar curMetaDeps;\r\nvar curEsModule = false;\r\nexport function clearLastDefine (metaDeps, esModule) {\r\n  curMetaDeps = metaDeps;\r\n  curEsModule = esModule;\r\n  lastNamedDefine = undefined;\r\n  multipleNamedDefines = false;\r\n}\r\nexport function registerLastDefine (loader) {\r\n  if (lastNamedDefine)\r\n    loader.registerDynamic(curMetaDeps ? lastNamedDefine[0].concat(curMetaDeps) : lastNamedDefine[0],\r\n        false, curEsModule ? wrapEsModuleExecute(lastNamedDefine[1]) : lastNamedDefine[1]);\r\n\r\n  // bundles are an empty module\r\n  else if (multipleNamedDefines)\r\n    loader.registerDynamic([], false, noop);\r\n}\r\n","import { scriptLoad, isBrowser, isWorker, global, cjsRequireRegEx, addToError, loadNodeModule,\r\n    warn, CONFIG, METADATA, emptyModule, protectedCreateNamespace, resolvedPromise, preloadScript, checkInstantiateWasm } from './common.js';\r\nimport { evaluate } from './evaluate.js';\r\nimport fetch from './fetch.js';\r\nimport { getGlobalValue, getCJSDeps, requireResolve, getPathVars, prepareGlobal, clearLastDefine, registerLastDefine } from './format-helpers.js';\r\n\r\nvar supportsScriptLoad = (isBrowser || isWorker) && typeof navigator !== 'undefined' && navigator.userAgent && !navigator.userAgent.match(/MSIE (9|10).0/);\r\n\r\n// include the node require since we're overriding it\r\nexport var nodeRequire;\r\nif (typeof require !== 'undefined' && typeof process !== 'undefined' && !process.browser)\r\n  nodeRequire = require;\r\n\r\nfunction setMetaEsModule (metadata, moduleValue) {\r\n  if (metadata.load.esModule && (typeof moduleValue === 'object' || typeof moduleValue === 'function') &&\r\n      !('__esModule' in moduleValue))\r\n    Object.defineProperty(moduleValue, '__esModule', {\r\n      value: true\r\n    });\r\n}\r\n\r\nexport function instantiate (key, processAnonRegister) {\r\n  var loader = this;\r\n  var config = this[CONFIG];\r\n  // first do bundles and depCache\r\n  return (loadBundlesAndDepCache(config, this, key) || resolvedPromise)\r\n  .then(function () {\r\n    if (processAnonRegister())\r\n      return;\r\n\r\n    var metadata = loader[METADATA][key];\r\n\r\n    // node module loading\r\n    if (key.substr(0, 6) === '@node/') {\r\n      if (!loader._nodeRequire)\r\n        throw new TypeError('Error loading ' + key + '. Can only load node core modules in Node.');\r\n      loader.registerDynamic([], false, function () {\r\n        return loadNodeModule.call(loader, key.substr(6), loader.baseURL);\r\n      });\r\n      processAnonRegister();\r\n      return;\r\n    }\r\n\r\n    if (metadata.load.scriptLoad ) {\r\n      if (metadata.load.pluginKey || !supportsScriptLoad) {\r\n        metadata.load.scriptLoad = false;\r\n        warn.call(config, 'scriptLoad not supported for \"' + key + '\"');\r\n      }\r\n    }\r\n    else if (metadata.load.scriptLoad !== false && !metadata.load.pluginKey && supportsScriptLoad) {\r\n      // auto script load AMD, global without deps\r\n      if (!metadata.load.deps && !metadata.load.globals &&\r\n          (metadata.load.format === 'system' || metadata.load.format === 'register' || metadata.load.format === 'global' && metadata.load.exports))\r\n        metadata.load.scriptLoad = true;\r\n    }\r\n\r\n    // fetch / translate / instantiate pipeline\r\n    if (!metadata.load.scriptLoad)\r\n      return initializePlugin(loader, key, metadata)\r\n      .then(function () {\r\n        return runFetchPipeline(loader, key, metadata, processAnonRegister, config.wasm);\r\n      })\r\n\r\n    // just script loading\r\n    return new Promise(function (resolve, reject) {\r\n      if (metadata.load.format === 'amd' && global.define !== loader.amdDefine)\r\n        throw new Error('Loading AMD with scriptLoad requires setting the global `' + globalName + '.define = SystemJS.amdDefine`');\r\n\r\n      scriptLoad(key, metadata.load.crossOrigin, metadata.load.integrity, function () {\r\n        if (!processAnonRegister()) {\r\n          metadata.load.format = 'global';\r\n          var globalValue = metadata.load.exports && getGlobalValue(metadata.load.exports);\r\n          loader.registerDynamic([], false, function () {\r\n            setMetaEsModule(metadata, globalValue);\r\n            return globalValue;\r\n          });\r\n          processAnonRegister();\r\n        }\r\n\r\n        resolve();\r\n      }, reject);\r\n    });\r\n  })\r\n  .then(function (instantiated) {\r\n    delete loader[METADATA][key];\r\n    return instantiated;\r\n  });\r\n};\r\n\r\nfunction initializePlugin (loader, key, metadata) {\r\n  if (!metadata.pluginKey)\r\n    return resolvedPromise;\r\n\r\n  return loader.import(metadata.pluginKey).then(function (plugin) {\r\n    metadata.pluginModule = plugin;\r\n    metadata.pluginLoad = {\r\n      name: key,\r\n      address: metadata.pluginArgument,\r\n      source: undefined,\r\n      metadata: metadata.load\r\n    };\r\n    metadata.load.deps = metadata.load.deps || [];\r\n  });\r\n}\r\n\r\nfunction loadBundlesAndDepCache (config, loader, key) {\r\n  // load direct deps, in turn will pick up their trace trees\r\n  var deps;\r\n  if (isBrowser && (deps = config.depCache[key])) {\r\n    for (var i = 0; i < deps.length; i++)\r\n      loader.normalize(deps[i], key).then(preloadScript);\r\n  }\r\n  else {\r\n    var matched = false;\r\n    for (var b in config.bundles) {\r\n      for (var i = 0; i < config.bundles[b].length; i++) {\r\n        var curModule = config.bundles[b][i];\r\n\r\n        if (curModule === key) {\r\n          matched = true;\r\n          break;\r\n        }\r\n\r\n        // wildcard in bundles includes / boundaries\r\n        if (curModule.indexOf('*') !== -1) {\r\n          var parts = curModule.split('*');\r\n          if (parts.length !== 2) {\r\n            config.bundles[b].splice(i--, 1);\r\n            continue;\r\n          }\r\n\r\n          if (key.substr(0, parts[0].length) === parts[0] &&\r\n              key.substr(key.length - parts[1].length, parts[1].length) === parts[1]) {\r\n            matched = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (matched)\r\n        return loader.import(b);\r\n    }\r\n  }\r\n}\r\n\r\nfunction runFetchPipeline (loader, key, metadata, processAnonRegister, wasm) {\r\n  if (metadata.load.exports && !metadata.load.format)\r\n    metadata.load.format = 'global';\r\n\r\n  return resolvedPromise\r\n\r\n  // locate\r\n  .then(function () {\r\n    if (!metadata.pluginModule || !metadata.pluginModule.locate)\r\n      return;\r\n\r\n    return Promise.resolve(metadata.pluginModule.locate.call(loader, metadata.pluginLoad))\r\n    .then(function (address) {\r\n      if (address)\r\n        metadata.pluginLoad.address = address;\r\n    });\r\n  })\r\n\r\n  // fetch\r\n  .then(function () {\r\n    if (!metadata.pluginModule)\r\n      return fetch(key, metadata.load.authorization, metadata.load.integrity, wasm);\r\n\r\n    wasm = false;\r\n\r\n    if (!metadata.pluginModule.fetch)\r\n      return fetch(metadata.pluginLoad.address, metadata.load.authorization, metadata.load.integrity, false);\r\n\r\n    return metadata.pluginModule.fetch.call(loader, metadata.pluginLoad, function (load) {\r\n      return fetch(load.address, metadata.load.authorization, metadata.load.integrity, false);\r\n    });\r\n  })\r\n\r\n  .then(function (fetched) {\r\n    // fetch is already a utf-8 string if not doing wasm detection\r\n    if (!wasm || typeof fetched === 'string')\r\n      return translateAndInstantiate(loader, key, fetched, metadata, processAnonRegister);\r\n\r\n    return checkInstantiateWasm(loader, fetched, processAnonRegister)\r\n    .then(function (wasmInstantiated) {\r\n      if (wasmInstantiated)\r\n        return;\r\n\r\n      // not wasm -> convert buffer into utf-8 string to execute as a module\r\n      // TextDecoder compatibility matches WASM currently. Need to keep checking this.\r\n      // The TextDecoder interface is documented at http://encoding.spec.whatwg.org/#interface-textdecoder\r\n      var stringSource = isBrowser ? new TextDecoder('utf-8').decode(new Uint8Array(fetched)) : fetched.toString();\r\n      return translateAndInstantiate(loader, key, stringSource, metadata, processAnonRegister);\r\n    });\r\n  });\r\n}\r\n\r\nfunction translateAndInstantiate (loader, key, source, metadata, processAnonRegister) {\r\n  return Promise.resolve(source)\r\n  // translate\r\n  .then(function (source) {\r\n    if (metadata.load.format === 'detect')\r\n      metadata.load.format = undefined;\r\n\r\n    readMetaSyntax(source, metadata);\r\n\r\n    if (!metadata.pluginModule)\r\n      return source;\r\n\r\n    metadata.pluginLoad.source = source;\r\n\r\n    if (!metadata.pluginModule.translate)\r\n      return source;\r\n\r\n    return Promise.resolve(metadata.pluginModule.translate.call(loader, metadata.pluginLoad, metadata.traceOpts))\r\n    .then(function (translated) {\r\n      if (metadata.load.sourceMap) {\r\n        if (typeof metadata.load.sourceMap !== 'object')\r\n          throw new Error('metadata.load.sourceMap must be set to an object.');\r\n        sanitizeSourceMap(metadata.pluginLoad.address, metadata.load.sourceMap);\r\n      }\r\n\r\n      if (typeof translated === 'string')\r\n        return translated;\r\n      else\r\n        return metadata.pluginLoad.source;\r\n    });\r\n  })\r\n  .then(function (source) {\r\n    if (!metadata.load.format && source.substring(0, 8) === '\"bundle\"') {\r\n      metadata.load.format = 'system';\r\n      return source;\r\n    }\r\n\r\n    if (metadata.load.format === 'register' || !metadata.load.format && detectRegisterFormat(source)) {\r\n      metadata.load.format = 'register';\r\n      return source;\r\n    }\r\n\r\n    if (metadata.load.format !== 'esm' && (metadata.load.format || !source.match(esmRegEx))) {\r\n      return source;\r\n    }\r\n\r\n    metadata.load.format = 'esm';\r\n    return transpile(loader, source, key, metadata, processAnonRegister);\r\n  })\r\n\r\n  // instantiate\r\n  .then(function (translated) {\r\n    if (typeof translated !== 'string' || !metadata.pluginModule || !metadata.pluginModule.instantiate)\r\n      return translated;\r\n\r\n    var calledInstantiate = false;\r\n    metadata.pluginLoad.source = translated;\r\n    return Promise.resolve(metadata.pluginModule.instantiate.call(loader, metadata.pluginLoad, function (load) {\r\n      translated = load.source;\r\n      metadata.load = load.metadata;\r\n      if (calledInstantiate)\r\n        throw new Error('Instantiate must only be called once.');\r\n      calledInstantiate = true;\r\n    }))\r\n    .then(function (result) {\r\n      if (calledInstantiate)\r\n        return translated;\r\n      return protectedCreateNamespace(result);\r\n    });\r\n  })\r\n  .then(function (source) {\r\n    // plugin instantiate result case\r\n    if (typeof source !== 'string')\r\n      return source;\r\n\r\n    if (!metadata.load.format)\r\n      metadata.load.format = detectLegacyFormat(source);\r\n\r\n    var registered = false;\r\n\r\n    switch (metadata.load.format) {\r\n      case 'esm':\r\n      case 'register':\r\n      case 'system':\r\n        var err = evaluate(loader, source, metadata.load.sourceMap, key, metadata.load.integrity, metadata.load.nonce, false);\r\n        if (err)\r\n          throw err;\r\n        if (!processAnonRegister())\r\n          return emptyModule;\r\n        return;\r\n      break;\r\n\r\n      case 'json':\r\n        // warn.call(config, '\"json\" module format is deprecated.');\r\n        var parsed = JSON.parse(source);\r\n        return loader.newModule({ default: parsed, __useDefault: parsed });\r\n\r\n      case 'amd':\r\n        var curDefine = global.define;\r\n        global.define = loader.amdDefine;\r\n\r\n        clearLastDefine(metadata.load.deps, metadata.load.esModule);\r\n\r\n        var err = evaluate(loader, source, metadata.load.sourceMap, key, metadata.load.integrity, metadata.load.nonce, false);\r\n\r\n        // if didn't register anonymously, use the last named define if only one\r\n        registered = processAnonRegister();\r\n        if (!registered) {\r\n          registerLastDefine(loader);\r\n          registered = processAnonRegister();\r\n        }\r\n\r\n        global.define = curDefine;\r\n\r\n        if (err)\r\n          throw err;\r\n      break;\r\n\r\n      case 'cjs':\r\n        var metaDeps = metadata.load.deps;\r\n        var deps = (metadata.load.deps || []).concat(metadata.load.cjsRequireDetection ? getCJSDeps(source) : []);\r\n\r\n        for (var g in metadata.load.globals)\r\n          if (metadata.load.globals[g])\r\n            deps.push(metadata.load.globals[g]);\r\n\r\n        loader.registerDynamic(deps, true, function (require, exports, module) {\r\n          require.resolve = function (key) {\r\n            return requireResolve.call(loader, key, module.id);\r\n          };\r\n          // support module.paths ish\r\n          module.paths = [];\r\n          module.require = require;\r\n\r\n          // ensure meta deps execute first\r\n          if (!metadata.load.cjsDeferDepsExecute && metaDeps)\r\n            for (var i = 0; i < metaDeps.length; i++)\r\n              require(metaDeps[i]);\r\n\r\n          var pathVars = getPathVars(module.id);\r\n          var __cjsWrapper = {\r\n            exports: exports,\r\n            args: [require, exports, module, pathVars.filename, pathVars.dirname, global, global]\r\n          };\r\n\r\n          var cjsWrapper = \"(function (require, exports, module, __filename, __dirname, global, GLOBAL\";\r\n\r\n          // add metadata.globals to the wrapper arguments\r\n          if (metadata.load.globals)\r\n            for (var g in metadata.load.globals) {\r\n              __cjsWrapper.args.push(require(metadata.load.globals[g]));\r\n              cjsWrapper += \", \" + g;\r\n            }\r\n\r\n          // disable AMD detection\r\n          var define = global.define;\r\n          global.define = undefined;\r\n          global.__cjsWrapper = __cjsWrapper;\r\n\r\n          source = cjsWrapper + \") {\" + source.replace(hashBangRegEx, '') + \"\\n}).apply(__cjsWrapper.exports, __cjsWrapper.args);\";\r\n\r\n          var err = evaluate(loader, source, metadata.load.sourceMap, key, metadata.load.integrity, metadata.load.nonce, false);\r\n          if (err)\r\n            throw err;\r\n\r\n          setMetaEsModule(metadata, exports);\r\n\r\n          global.__cjsWrapper = undefined;\r\n          global.define = define;\r\n        });\r\n        registered = processAnonRegister();\r\n      break;\r\n\r\n      case 'global':\r\n        var deps = metadata.load.deps || [];\r\n        for (var g in metadata.load.globals) {\r\n          var gl = metadata.load.globals[g];\r\n          if (gl)\r\n            deps.push(gl);\r\n        }\r\n\r\n        loader.registerDynamic(deps, false, function (require, exports, module) {\r\n          var globals;\r\n          if (metadata.load.globals) {\r\n            globals = {};\r\n            for (var g in metadata.load.globals)\r\n              if (metadata.load.globals[g])\r\n                globals[g] = require(metadata.load.globals[g]);\r\n          }\r\n\r\n          var exportName = metadata.load.exports;\r\n\r\n          if (exportName)\r\n            source += '\\n' + globalName + '[\"' + exportName + '\"] = ' + exportName + ';';\r\n\r\n          var retrieveGlobal = prepareGlobal(module.id, exportName, globals, metadata.load.encapsulateGlobal);\r\n          var err = evaluate(loader, source, metadata.load.sourceMap, key, metadata.load.integrity, metadata.load.nonce, true);\r\n\r\n          if (err)\r\n            throw err;\r\n\r\n          var output = retrieveGlobal();\r\n          setMetaEsModule(metadata, output);\r\n          return output;\r\n        });\r\n        registered = processAnonRegister();\r\n      break;\r\n\r\n      default:\r\n        throw new TypeError('Unknown module format \"' + metadata.load.format + '\" for \"' + key + '\".' + (metadata.load.format === 'es6' ? ' Use \"esm\" instead here.' : ''));\r\n    }\r\n\r\n    if (!registered)\r\n      throw new Error('Module ' + key + ' detected as ' + metadata.load.format + ' but didn\\'t execute correctly.');\r\n  });\r\n}\r\n\r\nvar globalName = typeof self != 'undefined' ? 'self' : 'global';\r\n\r\n// good enough ES6 module detection regex - format detections not designed to be accurate, but to handle the 99% use case\r\nexport var esmRegEx = /(^\\s*|[}\\);\\n]\\s*)(import\\s*(['\"]|(\\*\\s+as\\s+)?(?!type)([^\"'\\(\\)\\n; ]+)\\s*from\\s*['\"]|\\{)|export\\s+\\*\\s+from\\s+[\"']|export\\s*(\\{|default|function|class|var|const|let|async\\s+function))/;\r\n\r\nvar leadingCommentAndMetaRegEx = /^(\\s*\\/\\*[^\\*]*(\\*(?!\\/)[^\\*]*)*\\*\\/|\\s*\\/\\/[^\\n]*|\\s*\"[^\"]+\"\\s*;?|\\s*'[^']+'\\s*;?)*\\s*/;\r\nexport function detectRegisterFormat(source) {\r\n  var leadingCommentAndMeta = source.match(leadingCommentAndMetaRegEx);\r\n  if (!leadingCommentAndMeta)\r\n    return false;\r\n  var codeStart = leadingCommentAndMeta[0].length;\r\n  return source.startsWith('System.register', codeStart) || source.startsWith('SystemJS.register', codeStart);\r\n}\r\n\r\n// AMD Module Format Detection RegEx\r\n// define([.., .., ..], ...)\r\n// define(varName); || define(function(require, exports) {}); || define({})\r\nvar amdRegEx = /(?:^\\uFEFF?|[^$_a-zA-Z\\xA0-\\uFFFF.])define\\s*\\(\\s*(\"[^\"]+\"\\s*,\\s*|'[^']+'\\s*,\\s*)?\\s*(\\[(\\s*((\"[^\"]+\"|'[^']+')\\s*,|\\/\\/.*\\r?\\n|\\/\\*(.|\\s)*?\\*\\/))*(\\s*(\"[^\"]+\"|'[^']+')\\s*,?)?(\\s*(\\/\\/.*\\r?\\n|\\/\\*(.|\\s)*?\\*\\/))*\\s*\\]|function\\s*|{|[_$a-zA-Z\\xA0-\\uFFFF][_$a-zA-Z0-9\\xA0-\\uFFFF]*\\))/;\r\n\r\n/// require('...') || exports[''] = ... || exports.asd = ... || module.exports = ...\r\nvar cjsExportsRegEx = /(?:^\\uFEFF?|[^$_a-zA-Z\\xA0-\\uFFFF.])(exports\\s*(\\[['\"]|\\.)|module(\\.exports|\\['exports'\\]|\\[\"exports\"\\])\\s*(\\[['\"]|[=,\\.]))/;\r\nvar commentRegEx = /(^|[^\\\\])(\\/\\*([\\s\\S]*?)\\*\\/|([^:]|^)\\/\\/(.*)$)/mg;\r\n\r\nvar stringRegEx = /(\"[^\"\\\\\\n\\r]*(\\\\.[^\"\\\\\\n\\r]*)*\"|'[^'\\\\\\n\\r]*(\\\\.[^'\\\\\\n\\r]*)*')/g;\r\n\r\n// used to support leading #!/usr/bin/env in scripts as supported in Node\r\nvar hashBangRegEx = /^\\#\\!.*/;\r\n\r\nexport function detectLegacyFormat (source) {\r\n  if (source.match(amdRegEx))\r\n    return 'amd';\r\n\r\n  cjsExportsRegEx.lastIndex = 0;\r\n  cjsRequireRegEx.lastIndex = 0;\r\n  if (cjsRequireRegEx.exec(source) || cjsExportsRegEx.exec(source))\r\n    return 'cjs';\r\n\r\n  // global is the fallback format\r\n  return 'global';\r\n}\r\n\r\nfunction sanitizeSourceMap (address, sourceMap) {\r\n  var originalName = address.split('!')[0];\r\n\r\n  // force set the filename of the original file\r\n  if (!sourceMap.file || sourceMap.file == address)\r\n    sourceMap.file = originalName + '!transpiled';\r\n\r\n  // force set the sources list if only one source\r\n  if (!sourceMap.sources || sourceMap.sources.length <= 1 && (!sourceMap.sources[0] || sourceMap.sources[0] === address))\r\n    sourceMap.sources = [originalName];\r\n}\r\n\r\nfunction transpile (loader, source, key, metadata, processAnonRegister) {\r\n  if (!loader.transpiler)\r\n    throw new TypeError('Unable to dynamically transpile ES module\\n   A loader plugin needs to be configured via `SystemJS.config({ transpiler: \\'transpiler-module\\' })`.');\r\n\r\n  // deps support for es transpile\r\n  if (metadata.load.deps) {\r\n    var depsPrefix = '';\r\n    for (var i = 0; i < metadata.load.deps.length; i++)\r\n      depsPrefix += 'import \"' + metadata.load.deps[i] + '\"; ';\r\n    source = depsPrefix + source;\r\n  }\r\n\r\n  // do transpilation\r\n  return loader.import.call(loader, loader.transpiler)\r\n  .then(function (transpiler) {\r\n    transpiler = transpiler.__useDefault || transpiler;\r\n\r\n    // translate hooks means this is a transpiler plugin instead of a raw implementation\r\n    if (!transpiler.translate)\r\n      throw new Error(loader.transpiler + ' is not a valid transpiler plugin.');\r\n\r\n    // if transpiler is the same as the plugin loader, then don't run twice\r\n    if (transpiler === metadata.pluginModule)\r\n      return source;\r\n\r\n    // convert the source map into an object for transpilation chaining\r\n    if (typeof metadata.load.sourceMap === 'string')\r\n      metadata.load.sourceMap = JSON.parse(metadata.load.sourceMap);\r\n\r\n    metadata.pluginLoad = metadata.pluginLoad || {\r\n      name: key,\r\n      address: key,\r\n      source: source,\r\n      metadata: metadata.load\r\n    };\r\n    metadata.load.deps = metadata.load.deps || [];\r\n\r\n    return Promise.resolve(transpiler.translate.call(loader, metadata.pluginLoad, metadata.traceOpts))\r\n    .then(function (source) {\r\n      // sanitize sourceMap if an object not a JSON string\r\n      var sourceMap = metadata.load.sourceMap;\r\n      if (sourceMap && typeof sourceMap === 'object')\r\n        sanitizeSourceMap(key, sourceMap);\r\n\r\n      if (metadata.load.format === 'esm' && detectRegisterFormat(source))\r\n        metadata.load.format = 'register';\r\n\r\n      return source;\r\n    });\r\n  }, function (err) {\r\n    throw addToError(err, 'Unable to load transpiler to transpile ' + key);\r\n  });\r\n}\r\n\r\n// detect any meta header syntax\r\n// only set if not already set\r\nvar metaRegEx = /^(\\s*\\/\\*[^\\*]*(\\*(?!\\/)[^\\*]*)*\\*\\/|\\s*\\/\\/[^\\n]*|\\s*\"[^\"]+\"\\s*;?|\\s*'[^']+'\\s*;?)+/;\r\nvar metaPartRegEx = /\\/\\*[^\\*]*(\\*(?!\\/)[^\\*]*)*\\*\\/|\\/\\/[^\\n]*|\"[^\"]+\"\\s*;?|'[^']+'\\s*;?/g;\r\n\r\nfunction setMetaProperty(target, p, value) {\r\n  var pParts = p.split('.');\r\n  var curPart;\r\n  while (pParts.length > 1) {\r\n    curPart = pParts.shift();\r\n    target = target[curPart] = target[curPart] || {};\r\n  }\r\n  curPart = pParts.shift();\r\n  if (target[curPart] === undefined)\r\n    target[curPart] = value;\r\n}\r\n\r\nfunction readMetaSyntax (source, metadata) {\r\n  var meta = source.match(metaRegEx);\r\n  if (!meta)\r\n    return;\r\n\r\n  var metaParts = meta[0].match(metaPartRegEx);\r\n\r\n  for (var i = 0; i < metaParts.length; i++) {\r\n    var curPart = metaParts[i];\r\n    var len = curPart.length;\r\n\r\n    var firstChar = curPart.substr(0, 1);\r\n    if (curPart.substr(len - 1, 1) == ';')\r\n      len--;\r\n\r\n    if (firstChar != '\"' && firstChar != \"'\")\r\n      continue;\r\n\r\n    var metaString = curPart.substr(1, curPart.length - 3);\r\n    var metaName = metaString.substr(0, metaString.indexOf(' '));\r\n\r\n    if (metaName) {\r\n      var metaValue = metaString.substr(metaName.length + 1, metaString.length - metaName.length - 1);\r\n\r\n      if (metaName === 'deps')\r\n        metaName = 'deps[]';\r\n\r\n      if (metaName.substr(metaName.length - 2, 2) === '[]') {\r\n        metaName = metaName.substr(0, metaName.length - 2);\r\n        metadata.load[metaName] = metadata.load[metaName] || [];\r\n        metadata.load[metaName].push(metaValue);\r\n      }\r\n      // \"use strict\" is not meta\r\n      else if (metaName !== 'use') {\r\n        setMetaProperty(metadata.load, metaName, metaValue);\r\n      }\r\n    }\r\n    else {\r\n      metadata.load[metaString] = true;\r\n    }\r\n  }\r\n}\r\n","import RegisterLoader from 'es-module-loader/core/register-loader.js';\r\nimport { warn, isBrowser, global, baseURI, CONFIG, METADATA, ModuleNamespace, emptyModule, isModule } from './common.js';\r\n\r\nimport { getConfig, getConfigItem, setConfig } from './config.js';\r\nimport { decanonicalize, normalize, normalizeSync } from './resolve.js';\r\nimport { instantiate, nodeRequire } from './instantiate.js';\r\nimport { setHelpers, setAmdHelper } from './format-helpers.js';\r\n\r\nexport default SystemJSLoader;\r\n\r\nvar scriptSrc;\r\n\r\n// Promise detection and error message\r\nif (typeof Promise === 'undefined')\r\n  throw new Error('SystemJS needs a Promise polyfill.');\r\n\r\nif (typeof document !== 'undefined') {\r\n  var scripts = document.getElementsByTagName('script');\r\n  var curScript = scripts[scripts.length - 1];\r\n  if (document.currentScript && (curScript.defer || curScript.async))\r\n    curScript = document.currentScript;\r\n\r\n  scriptSrc = curScript && curScript.src;\r\n}\r\n// worker\r\nelse if (typeof importScripts !== 'undefined') {\r\n  try {\r\n    throw new Error('_');\r\n  }\r\n  catch (e) {\r\n    e.stack.replace(/(?:at|@).*(http.+):[\\d]+:[\\d]+/, function(m, url) {\r\n      scriptSrc = url;\r\n    });\r\n  }\r\n}\r\n// node\r\nelse if (typeof __filename !== 'undefined') {\r\n  scriptSrc = __filename;\r\n}\r\n\r\nfunction SystemJSLoader () {\r\n  RegisterLoader.call(this);\r\n\r\n  // NB deprecate\r\n  this._loader = {};\r\n\r\n  // internal metadata store\r\n  this[METADATA] = {};\r\n\r\n  // internal configuration\r\n  this[CONFIG] = {\r\n    baseURL: baseURI,\r\n    paths: {},\r\n\r\n    packageConfigPaths: [],\r\n    packageConfigKeys: [],\r\n    map: {},\r\n    packages: {},\r\n    depCache: {},\r\n    meta: {},\r\n    bundles: {},\r\n\r\n    production: false,\r\n\r\n    transpiler: undefined,\r\n    loadedBundles: {},\r\n\r\n    // global behaviour flags\r\n    warnings: false,\r\n    pluginFirst: false,\r\n\r\n    // enable wasm loading and detection when supported\r\n    wasm: false\r\n  };\r\n\r\n  // make the location of the system.js script accessible (if any)\r\n  this.scriptSrc = scriptSrc;\r\n\r\n  this._nodeRequire = nodeRequire;\r\n\r\n  // support the empty module, as a concept\r\n  this.registry.set('@empty', emptyModule);\r\n\r\n  setProduction.call(this, false, false);\r\n\r\n  // add module format helpers\r\n  setHelpers(this);\r\n  setAmdHelper(this);\r\n}\r\n\r\nexport var envModule;\r\nexport function setProduction (isProduction, isBuilder) {\r\n  this[CONFIG].production = isProduction;\r\n  this.registry.set('@system-env', envModule = this.newModule({\r\n    browser: isBrowser,\r\n    node: !!this._nodeRequire,\r\n    production: !isBuilder && isProduction,\r\n    dev: isBuilder || !isProduction,\r\n    build: isBuilder,\r\n    'default': true\r\n  }));\r\n}\r\n\r\nSystemJSLoader.prototype = Object.create(RegisterLoader.prototype);\r\n\r\nSystemJSLoader.prototype.constructor = SystemJSLoader;\r\n\r\n// NB deprecate normalize\r\nSystemJSLoader.prototype[SystemJSLoader.resolve = RegisterLoader.resolve] = SystemJSLoader.prototype.normalize = normalize;\r\n\r\nSystemJSLoader.prototype.load = function (key, parentKey) {\r\n  warn.call(this[CONFIG], 'System.load is deprecated.');\r\n  return this.import(key, parentKey);\r\n};\r\n\r\n// NB deprecate decanonicalize, normalizeSync\r\nSystemJSLoader.prototype.decanonicalize = SystemJSLoader.prototype.normalizeSync = SystemJSLoader.prototype.resolveSync = normalizeSync;\r\n\r\nSystemJSLoader.prototype[SystemJSLoader.instantiate = RegisterLoader.instantiate] = instantiate;\r\n\r\nSystemJSLoader.prototype.config = setConfig;\r\nSystemJSLoader.prototype.getConfig = getConfig;\r\n\r\nSystemJSLoader.prototype.global = global;\r\n\r\nSystemJSLoader.prototype.import = function () {\r\n  return RegisterLoader.prototype.import.apply(this, arguments)\r\n  .then(function (m) {\r\n    return '__useDefault' in m ? m.__useDefault : m;\r\n  });\r\n};\r\n\r\nexport var configNames = ['baseURL', 'map', 'paths', 'packages', 'packageConfigPaths', 'depCache', 'meta', 'bundles', 'transpiler', 'warnings', 'pluginFirst', 'production', 'wasm'];\r\n\r\nvar hasProxy = typeof Proxy !== 'undefined';\r\nfor (var i = 0; i < configNames.length; i++) (function (configName) {\r\n  Object.defineProperty(SystemJSLoader.prototype, configName, {\r\n    get: function () {\r\n      var cfg = getConfigItem(this[CONFIG], configName);\r\n\r\n      if (hasProxy && typeof cfg === 'object')\r\n        cfg = new Proxy(cfg, {\r\n          set: function (target, option) {\r\n            throw new Error('Cannot set SystemJS.' + configName + '[\"' + option + '\"] directly. Use SystemJS.config({ ' + configName + ': { \"' + option + '\": ... } }) rather.');\r\n          }\r\n        });\r\n\r\n      //if (typeof cfg === 'object')\r\n      //  warn.call(this[CONFIG], 'Referencing `SystemJS.' + configName + '` is deprecated. Use the config getter `SystemJS.getConfig(\\'' + configName + '\\')`');\r\n      return cfg;\r\n    },\r\n    set: function (name) {\r\n      throw new Error('Setting `SystemJS.' + configName + '` directly is no longer supported. Use `SystemJS.config({ ' + configName + ': ... })`.');\r\n    }\r\n  });\r\n})(configNames[i]);\r\n\r\n/*\r\n * Backwards-compatible registry API, to be deprecated\r\n */\r\nfunction registryWarn(loader, method) {\r\n  warn.call(loader[CONFIG], 'SystemJS.' + method + ' is deprecated for SystemJS.registry.' + method);\r\n}\r\nSystemJSLoader.prototype.delete = function (key) {\r\n  registryWarn(this, 'delete');\r\n  return this.registry.delete(key);\r\n};\r\nSystemJSLoader.prototype.get = function (key) {\r\n  registryWarn(this, 'get');\r\n  return this.registry.get(key);\r\n};\r\nSystemJSLoader.prototype.has = function (key) {\r\n  registryWarn(this, 'has');\r\n  return this.registry.has(key);\r\n};\r\nSystemJSLoader.prototype.set = function (key, module) {\r\n  registryWarn(this, 'set');\r\n  return this.registry.set(key, module);\r\n};\r\nSystemJSLoader.prototype.newModule = function (bindings) {\r\n  return new ModuleNamespace(bindings);\r\n};\r\nSystemJSLoader.prototype.isModule = isModule;\r\n\r\n// ensure System.register and System.registerDynamic decanonicalize\r\nSystemJSLoader.prototype.register = function (key, deps, declare) {\r\n  if (typeof key === 'string')\r\n    key = decanonicalize.call(this, this[CONFIG], key);\r\n  return RegisterLoader.prototype.register.call(this, key, deps, declare);\r\n};\r\n\r\nSystemJSLoader.prototype.registerDynamic = function (key, deps, executingRequire, execute) {\r\n  if (typeof key === 'string')\r\n    key = decanonicalize.call(this, this[CONFIG], key);\r\n  return RegisterLoader.prototype.registerDynamic.call(this, key, deps, executingRequire, execute);\r\n};\r\n","import { global, isBrowser, isWorker } from './common.js';\r\nimport SystemJSLoader from './systemjs-loader.js';\r\n\r\nSystemJSLoader.prototype.version = VERSION;\r\n\r\nvar System = new SystemJSLoader();\r\n\r\n// only set the global System on the global in browsers\r\nif (isBrowser || isWorker)\r\n  global.SystemJS = global.System = System;\r\n\r\nif (typeof module !== 'undefined' && module.exports)\r\n  module.exports = System;\r\n"]}